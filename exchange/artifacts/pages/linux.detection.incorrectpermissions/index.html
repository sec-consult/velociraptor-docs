<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.139.4"><meta name=description content><link rel=icon href=/images/favicon.png type=image/png><title>Linux.Detection.IncorrectPermissions :: Velociraptor - Digging deeper!</title>
<link href=/css/nucleus.css?1740233288 rel=stylesheet><link href=/css/fontawesome-all.min.css?1740233288 rel=stylesheet><link href=/css/featherlight.min.css?1740233288 rel=stylesheet><link href=/css/perfect-scrollbar.min.css?1740233288 rel=stylesheet><link href=/css/auto-complete.css?1740233288 rel=stylesheet><link href=/css/theme.css?1740233288 rel=stylesheet><link href=/css/tabs.css?1740233288 rel=stylesheet><link href=/css/hugo-theme.css?1740233288 rel=stylesheet><link href=/css/theme-mine.css?1740233288 rel=stylesheet><link href=/css/dark.css?1740233288 rel=stylesheet><link href=/css/syntax.css?1740233288 rel=stylesheet><link href=/css/light.css?1740233288 rel=stylesheet><link href=/css/hljs.css?1740233288 rel=stylesheet><link href=https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css?1740233288 rel=stylesheet><script src=/js/jquery-3.3.1.min.js?1740233288></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style><script async src="https://www.googletagmanager.com/gtag/js?id=G-QYH72LMYCS"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-QYH72LMYCS")}</script><script></script></head><body data-url=/exchange/artifacts/pages/linux.detection.incorrectpermissions/><nav id=sidebar><div id=header-wrapper><div id=header><script>function darkmode(){$("body").addClass("dark").removeClass("light"),document.cookie="theme=darkmode;path=/"}function lightmode(){$("body").removeClass("dark").addClass("light"),document.cookie="theme=lightmode;path=/"}const regex=new RegExp("theme=darkmode");regex.test(document.cookie)?darkmode():lightmode()</script><div class="btn btn-default ThemeSelector darkmode" onclick=darkmode()><i class="fas fa-moon"></i></div><div class="btn btn-default ThemeSelector lightmode" onclick=lightmode()><i class="fas fa-sun"></i></div><a href=https://docs.velociraptor.app/><img src=https://docs.velociraptor.app//images/logo.svg></a></div></div><div class=highlightable><ul class=topics><li data-nav-id=https://docs.velociraptor.app/announcements/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/announcements/><i class="fas fa-bullhorn"></i>Announcements</a></div><ul><li data-nav-id=https://docs.velociraptor.app/announcements/advisories/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/announcements/advisories/><i class="fas fa-exclamation-triangle"></i>Security Advisories</a></div><ul><li data-nav-id=https://docs.velociraptor.app/announcements/advisories/cve-2024-10526/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/announcements/advisories/cve-2024-10526/>CVE-2024-10526</a></div></li><li data-nav-id=https://docs.velociraptor.app/announcements/advisories/cve-2023-5950/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/announcements/advisories/cve-2023-5950/>CVE-2023-5950</a></div></li><li data-nav-id=https://docs.velociraptor.app/announcements/advisories/cve-2023-2226/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/announcements/advisories/cve-2023-2226/>CVE-2023-2226</a></div></li><li data-nav-id=https://docs.velociraptor.app/announcements/advisories/cve-2023-0242/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/announcements/advisories/cve-2023-0242/>CVE-2023-0242</a></div></li><li data-nav-id=https://docs.velociraptor.app/announcements/advisories/cve-2023-0290/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/announcements/advisories/cve-2023-0290/>CVE-2023-0290</a></div></li></ul></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/><i class="fas fa-book-reader"></i>Documentation</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/overview/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/overview/>Velociraptor Overview</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/overview/history/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/overview/history/>History</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/overview/support/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/overview/support/>Support Policy</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/deployment/>Deployment</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/deployment/self-signed/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/self-signed/>Self-Signed SSL</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/cloud/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/deployment/cloud/>Cloud Deployment</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/deployment/cloud/multifrontend/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/cloud/multifrontend/>Multi-Frontend</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/orgs/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/orgs/>Organizations</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/clients/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/clients/>Deploying Clients</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/security/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/security/>Security</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/resources/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/resources/>Performance</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/troubleshooting/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/troubleshooting/>Troubleshooting</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/references/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/deployment/references/><i class="fas fa-book"></i>Config Reference</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/deployment/references/_reference/ class=dd-item><div><a href=/docs/deployment/references/_reference/></a></div></li></ul></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/gui/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/gui/>The Admin GUI</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/clients/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/clients/>Managing Clients</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/clients/searching/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/clients/searching/>Searching for clients</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/clients/interrogation/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/clients/interrogation/>Interrogation</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/clients/artifacts/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/clients/artifacts/>Collecting Artifacts</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/clients/labels/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/clients/labels/>Labels</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/clients/metadata/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/clients/metadata/>Metadata</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/clients/quarantine/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/clients/quarantine/>Quarantine</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/clients/vfs/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/clients/vfs/>Virtual File System</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/clients/shell/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/clients/shell/>Shell Commands</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/clients/monitoring/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/clients/monitoring/>Monitoring</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/clients/troubleshooting/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/clients/troubleshooting/>Troubleshooting</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/vql/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/vql/>VQL</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/vql/fundamentals/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/vql/fundamentals/>VQL Fundamentals</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/vql/events/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/vql/events/>Event Queries</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/vql/join/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/vql/join/>JOIN in VQL</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/vql/extending_vql/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/vql/extending_vql/>Extending VQL</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/vql/vql_reference/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/vql/vql_reference/><i class="fas fa-book"></i>VQL Reference</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/artifacts/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/artifacts/>Artifacts</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/artifacts/artifact_reference/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/artifacts/artifact_reference/><i class="fas fa-book"></i>Artifact Reference</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/artifacts/exchange_reference/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/artifacts/exchange_reference/><i class="fas fa-code"></i>Artifact Exchange</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/notebooks/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/notebooks/>Notebooks</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/hunting/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/hunting/>Hunting</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/forensic/>Forensic Analysis</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/forensic/filesystem/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/forensic/filesystem/>Searching Filenames</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/forensic/filesystem/paths/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/filesystem/paths/>Velociraptor Paths</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/filesystem/remapping/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/filesystem/remapping/>Remapping Accessors</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/searching/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/searching/>Searching Content</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/ntfs/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/ntfs/>NTFS Analysis</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/binary/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/binary/>Binary parsing</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/evidence_of_execution/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/evidence_of_execution/>Evidence Of Execution</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/event_logs/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/event_logs/>Event Logs</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/volatile/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/volatile/>Volatile State</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/offline_triage/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/offline_triage/>Triage and acquisition</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/offline_triage/remote_uploads/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/offline_triage/remote_uploads/>Remote Uploads</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/server_automation/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/server_automation/>Server Automation</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/server_automation/server_api/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/server_automation/server_api/>Server API</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/server_automation/server_monitoring/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/server_automation/server_monitoring/>Server Monitoring</a></div></li></ul></li></ul></li><li data-nav-id=https://docs.velociraptor.app/downloads/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/downloads/><i class="fas fa-download"></i>Downloads</a></div></li><hr><li data-nav-id=https://docs.velociraptor.app/vql_reference/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/vql_reference/><i class="fas fa-book"></i>VQL Reference</a></div><ul><li data-nav-id=https://docs.velociraptor.app/vql_reference/popular/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/popular/>Frequently Used ✨</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/windows/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/windows/>Windows-only</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/linux/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/linux/>Linux-only</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/server/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/server/>Server-only</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/parsers/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/parsers/>Parsers</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/encode/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/encode/>Encode/Decode</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/event/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/event/>Event Plugins</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/experimental/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/experimental/>Experimental</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/developer/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/developer/>Developer</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/other/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/other/>Other</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/accessors/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/accessors/>Accessors</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/training/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/training/><i class="fas fa-graduation-cap"></i>Training</a></div><ul><li data-nav-id=https://docs.velociraptor.app/training/playbooks/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/training/playbooks/><i class="fas fa-play"></i>Playbooks</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/blog/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/blog/><i class="fas fa-newspaper"></i>Blog</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/presentations/><i class="fas fa-chalkboard-teacher"></i>Presentations</a></div><ul><li data-nav-id=https://docs.velociraptor.app/presentations/2022_linuxconf_au/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2022_linuxconf_au/>Linux Conf Au 2022</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2022_auscert/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2022_auscert/>Auscert 2022</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2022_sans_summit/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2022_sans_summit/>SANS Summit 2022</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2022_velocon/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2022_velocon/>Velocon 2022</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2022_dfrws_apac/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2022_dfrws_apac/>DFRWS APAC 2022</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2023_everything_open/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2023_everything_open/>EverythingOpen 2023</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2023_velocon/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2023_velocon/>VeloCON 2023</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2024_auscert/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2024_auscert/>Auscert 2024</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2024_auscert-detection-engineering/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2024_auscert-detection-engineering/>Auscert 2024 Talk</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/exchange/ class="dd-item parent haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/exchange/><i class="fas fa-code"></i>Artifact Exchange</a></div></li><li data-nav-id=https://docs.velociraptor.app/artifact_references/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/artifact_references/><i class="fas fa-book"></i>Artifact Reference</a></div></li><li data-nav-id=https://docs.velociraptor.app/knowledge_base/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/knowledge_base/><i class="fas fa-brain"></i>Knowledge Base</a></div></li><li data-nav-id=https://docs.velociraptor.app/search/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/search/><i class='fas fa-search'></i>Search</a></div></li></ul><hr><section id=shortcuts><h3></h3><ul><li><a class=padding href=https://github.com/Velocidex/velociraptor><i class='fab fa-github'></i>Github</a></li><li><a class=padding href=https://docs.velociraptor.app/discord/><i class='fab fa-discord'></i>Discord</a></li><li><a class=padding href=https://docs.velociraptor.app/youtube/><i class='fab fa-youtube'></i>YouTube</a></li><li><a class=padding href=mailto:velociraptor-discuss@googlegroups.com><i class='fas fa-envelope'></i>Mailing List</a></li><li><a class=padding href=https://docs.velociraptor.app/rss/><i class='fas fa-rss'></i>RSS</a></li><li><a class=padding href=https://docs.rapid7.com/insightidr/velociraptor-integration/><i class='fa fa-question-circle'></i>Rapid7 Docs</a></li></ul></section><section id=footer><div class=footer-copyright>Brought to you by
<img src=/images/Rapid7_logo.svg class=rapid7><br><i class="fas fa-copyright"></i> 2024</div></section></div></nav><script>$("#sidebar i.fa-angle-right").each(function(){$(this).parent().parent().find("ul").hide()})</script><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=top-github-link><a class=github-link title='Edit this page' href=https://github.com/Velocidex/velociraptor-docs/edit/master/content/exchange/artifacts/Linux.Detection.IncorrectPermissions.yaml target=blank><i class="fas fa-code-branch"></i>
<span id=top-github-link-text>Edit this page</span></a></div><div id=breadcrumbs itemscope itemtype=http://schema.org/BreadcrumbList><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i>
</a></span><span id=toc-menu><i class="fas fa-list-alt"></i></span>
<span class=links itemprop=itemListElement itemscope itemtype=http://schema.org/ListItem><span itemprop=item><span itemprop=name>Linux.Detection.IncorrectPermissions</span></span>
<meta itemprop=position content="1"></span></div><div class=progress><div class=wrapper><nav id=TableOfContents></nav></div></div></div></div><div id=head-tags></div><div id=body-inner><h1>Linux.Detection.IncorrectPermissions</h1><p>NOTE: Requires velociraptor 0.7.1 or higher. – Alternatively, import the
artifact dependency Linux.Sys.Groups manually into your installation.</p><p>This artifacts checks a number of files and directories to verify whether
they have the expected owner, group owner and mode. A file with an incorrect
owner may allow attackers to modify important system files. Similarly,
incorrect mode, like word-writable configuration or passwd/shadow files may
also be signs of serious misconfiguration or signs of malicious activity.</p><p>The parameter FilesToInspect contains lines of globs to search for. Each
line may specify expected user, expected group, expected file mode and
expected directory mode. It is very important that the order of the lines
is in order of increasing specificity. For example:</p><pre><code class=language-csv>/etc/*,root,root,644,755
/etc/?shadow*,,shadow,640,
</code></pre><p>Here, every file in the directory /etc is expected to be owned by root:root
and have file permissions set to 644, and group permissions set to 755.
The files under /etc matching &ldquo;?shadow*&rdquo; are still expected to be owned by
root, since the override for user is empty, but the group is no longer
expected to be &ldquo;root&rdquo;, but &ldquo;shadow&rdquo;. File permissions should be &ldquo;640&rdquo;
instead of &ldquo;644&rdquo;. Note that this is an example and will most likely return
hits, since a number of files in /etc have different owners and modes.</p><p>&ldquo;User&rdquo; may either be an integer (UID) or a string (username). &ldquo;Group&rdquo;
may be either an integer (GID) or a string (group name). The names for all
UIDs and GIDs are looked up and displayed along with their IDs in the result.</p><p>Modes may be specified in either octal numbers or strings.</p><p>Modes specified in octal numbers, e.g. 755, 640, 1777, are matched
using a regular expression, so that both &ldquo;0640&rdquo;, &ldquo;640&rdquo; and &ldquo;100640&rdquo; matches
&ldquo;100640&rdquo;. An implicit anchor, &lsquo;$&rsquo;, is used to match against the end of the
octal mode string.</p><p>When using mode strings (NumericMode unchecked), modes take the format
&ldquo;-rwx-r-x-r-x&rdquo;. Regex comparison is used, and an implicit &lsquo;$&rsquo; anchor
is inserted at the end of the string. String modes allows for verifying only
certain bits of permissions, like ensuring that only the owner has write
access, no one has permission to execute, but read access is not important:
&ldquo;r.-.&ndash;.&ndash;&rdquo;. Or ensuring that SUID/GUID is not set. For finding files
specifically with SUID set, look at Linux.Sys.SUID.</p><p>Mixing both formats is not supported and will result in unexpected results.</p><p>This artifact can also be used to look for all files owned by root with
world-writable permissions, for instance. Uncheck NumericMode, add a glob,
select &ldquo;root&rdquo; as owner and enter any invalid permission string in UserMode.
This will return every file owned by root. In the notebook, add something
like &ldquo;WHERE Mode=~&lsquo;w.$&rsquo;&rdquo; to the query. The User field may also be empty,
essentially returning every file in the glob as long as the UserMode field
contains an invalid value. This turns this artifact into a file finder-like
tool with metadata like username and group names for further processing.</p><p>The following columns are returned:</p><ul><li>OSPath</li><li>IsDir</li><li>UID</li><li>User</li><li>EUser (expected user from FilesToInspect)</li><li>GID</li><li>Group</li><li>EGroup (expected group from FilesToInspect)</li><li>Mode (file/directory mode/permissions)</li><li>EMode (expected file/directory mode from FilesToInspect)</li><li>Mismatch (a comma-separated string of one or several of &ldquo;uid&rdquo;, &ldquo;gid&rdquo; and &ldquo;mode&rdquo;)</li><li>Mtime</li><li>Ctime</li><li>Atime</li></ul><p>Note that the artifacts used to look up usernames and group names use the
files /etc/passwd and /etc/group. You will have to modify this artifact to
use <code>getent passwd</code>/<code>getent group</code> to use NSS and get users and groups from
Active Directory etc.</p><p>The provided default values in FilesToInspect is an example only.</p><pre><code class=language-yaml>
name: Linux.Detection.IncorrectPermissions
author: Andreas Misje – @misje
description: |
    NOTE: Requires velociraptor 0.7.1 or higher. – Alternatively, import the
    artifact dependency Linux.Sys.Groups manually into your installation.

    This artifacts checks a number of files and directories to verify whether
    they have the expected owner, group owner and mode. A file with an incorrect
    owner may allow attackers to modify important system files. Similarly,
    incorrect mode, like word-writable configuration or passwd/shadow files may
    also be signs of serious misconfiguration or signs of malicious activity.

    The parameter FilesToInspect contains lines of globs to search for. Each
    line may specify expected user, expected group, expected file mode and
    expected directory mode. It is very important that the order of the lines
    is in order of increasing specificity. For example:

    ```csv
    /etc/*,root,root,644,755
    /etc/?shadow*,,shadow,640,
    ```

    Here, every file in the directory /etc is expected to be owned by root:root
    and have file permissions set to 644, and group permissions set to 755.
    The files under /etc matching "?shadow*" are still expected to be owned by
    root, since the override for user is empty, but the group is no longer
    expected to be "root", but "shadow". File permissions should be "640"
    instead of "644". Note that this is an example and will most likely return
    hits, since a number of files in /etc have different owners and modes.

    "User" may either be an integer (UID) or a string (username). "Group"
    may be either an integer (GID) or a string (group name). The names for all
    UIDs and GIDs are looked up and displayed along with their IDs in the result.

    Modes may be specified in either octal numbers or strings.

    Modes specified in octal numbers, e.g. 755, 640, 1777, are matched
    using a regular expression, so that both "0640", "640" and "100640" matches
    "100640". An implicit anchor, '$', is used to match against the end of the
    octal mode string.

    When using mode strings (NumericMode unchecked), modes take the format
    "-rwx-r-x-r-x". Regex comparison is used, and an implicit '$' anchor
    is inserted at the end of the string. String modes allows for verifying only
    certain bits of permissions, like ensuring that only the owner has write 
    access, no one has permission to execute, but read access is not important:
    "r.-.--.--". Or ensuring that SUID/GUID is not set. For finding files
    specifically with SUID set, look at Linux.Sys.SUID.

    Mixing both formats is not supported and will result in unexpected results.

    This artifact can also be used to look for all files owned by root with
    world-writable permissions, for instance. Uncheck NumericMode, add a glob,
    select "root" as owner and enter any invalid permission string in UserMode.
    This will return every file owned by root. In the notebook, add something
    like "WHERE Mode=~'w.$'" to the query. The User field may also be empty,
    essentially returning every file in the glob as long as the UserMode field
    contains an invalid value. This turns this artifact into a file finder-like
    tool with metadata like username and group names for further processing.

    The following columns are returned:

      - OSPath
      - IsDir
      - UID
      - User
      - EUser (expected user from FilesToInspect)
      - GID
      - Group
      - EGroup (expected group from FilesToInspect)
      - Mode (file/directory mode/permissions)
      - EMode (expected file/directory mode from FilesToInspect)
      - Mismatch (a comma-separated string of one or several of "uid", "gid" and "mode")
      - Mtime
      - Ctime
      - Atime

    Note that the artifacts used to look up usernames and group names use the
    files /etc/passwd and /etc/group. You will have to modify this artifact to
    use `getent passwd`/`getent group` to use NSS and get users and groups from
    Active Directory etc.

    The provided default values in FilesToInspect is an example only.

parameters:
  - name: FilesToInspect
    type: csv
    default: |
        Globs,User,Group,FileMode,DirMode
        /etc/passwd?,root,root,644,
        /etc/?shadow?,root,shadow,640,
        /etc/group?,root,root,,
    description: The files to investigate. The default is just an example.
  - name: NumericMode
    type: bool
    default: true
    description: |
        Whether modes should be interpreted, compared and presented as octal
        numbers (e.g. 640) rather than strings (e.g. -rw-rw-r--)
  - name: IncludeDirs
    type: bool
    description: Include directories
  - name: FollowLinks
    type: bool
    description: Inlcude all symlinks, even though they may interfere with the results

precondition: |
    SELECT OS From info() WHERE OS = 'linux'

sources:
    - name: Discrepancies
      query: |
        /* Passwd/group will be looked up a lot. Make it efficient: */
        LET Users &lt;= memoize(query={
            SELECT int(int=Uid) AS UID, User FROM Artifact.Linux.Sys.Users()
        }, key='UID')
        LET Groups &lt;= memoize(query={
            SELECT GID, Group FROM Artifact.Linux.Sys.Groups()
        }, key='GID')

        LET FindUser(uid) = get(item=Users, field=uid).User
        LET FindGroup(gid) = get(item=Groups, field=gid).Group
        LET StrIf(str) = if(condition=str, then=str(str=str))

        LET Files = SELECT OSPath, IsDir, ModeString,
            /* If the globs are specified in the correct order, picking the
               last item will get a correct override behaviour: */
            /* Filter out all empty strings and keep integers: */
            filter(list=enumerate(items=User), regex='.', condition='x=&gt;true')[-1] AS EUser,
            filter(list=enumerate(items=Group), regex='.', condition='x=&gt;true')[-1] AS EGroup,
            filter(list=enumerate(items=FileMode), regex='.', condition='x=&gt;true')[-1] AS FMode,
            filter(list=enumerate(items=DirMode), regex='.', condition='x=&gt;true')[-1] AS DMode
            /* globs() can of course take a list of globs, like FilesToInspect.Globs,
               but by using that approach, we would no longer be able to tie
               User, Group etc. to the individual globs: */
            FROM foreach(row={
                SELECT Globs AS _Globs, * FROM FilesToInspect
            }, query={
                SELECT OSPath, IsDir, User, Group, FileMode, DirMode,
                    Mode.String AS ModeString
                    FROM glob(globs=_Globs)
                    WHERE (IncludeDirs OR NOT IsDir) AND (NOT IsLink OR FollowLinks)
            })
            GROUP BY OSPath

        LET FilesInfo = SELECT * FROM foreach(row=Files, async=true, query={
            SELECT OSPath, Sys.Uid AS UID, Sys.Gid AS GID, if(condition=NumericMode,
                    then=format(format='%o', args=[Sys.Mode]), else=ModeString)
                AS Mode, Mtime, Atime, Ctime, EUser, EGroup, log(message='%v, %v, %v', args=[Sys.Mode, ModeString, FMode]), StrIf(str=FMode) AS FMode,
                StrIf(str=DMode) AS DMode, IsDir
                FROM stat(filename=OSPath)
            })
            GROUP BY OSPath

        LET _UIDFiltered = SELECT OSPath, IsDir,
            UID,
            EUser,
            GID, FindGroup(gid=GID) AS Group,
            null AS EGroup,
            'uid' AS Mismatch,
            Mode,
            null AS EMode,
            Mtime, Atime, Ctime,
            get(item=Users, field=UID) AS _u
            FROM FilesInfo
            WHERE EUser AND _u.UID=UID AND
                /* User can be either an ID or a string: */
                if(condition=EUser=~'^\\d+$', then=EUser!=UID,
                            else=EUser!=_u.User)

        LET _GIDFiltered = SELECT OSPath, IsDir,
            UID, FindUser(uid=UID) AS User,
            EUser,
            GID,
            EGroup,
            'gid' AS Mismatch,
            Mode,
            null AS EMode,
            Mtime, Atime, Ctime,
            get(item=Groups, field=GID) AS _g
            FROM FilesInfo
            WHERE EGroup AND _g.GID=GID AND
                if(condition=EGroup=~'^\\d+$', then=EGroup!=GID,
                            else=EGroup!=_g.Group)

        LET _FileModeFiltered = SELECT OSPath, IsDir,
            UID, FindUser(uid=UID) AS User,
            EUser,
            GID, FindGroup(gid=GID) AS Group,
            EGroup,
            'mode' AS Mismatch,
            Mode,
            FMode AS EMode,
            Mtime, Atime, Ctime
            FROM FilesInfo
            WHERE NOT IsDir AND FMode AND NOT Mode=~FMode+'$'

        LET _DirModeFiltered = SELECT OSPath, IsDir,
            UID, FindUser(uid=UID) AS User,
            EUser,
            GID, FindGroup(gid=GID) AS Group,
            EGroup,
            'mode' AS Mismatch,
            Mode,
            DMode AS EMode,
            Mtime, Atime, Ctime
            FROM FilesInfo
            WHERE IsDir AND DMode AND NOT Mode=~DMode+'$'

        SELECT OSPath, IsDir, UID, User, EUser, GID, Group, EGroup, Mode, EMode,
            join(array=enumerate(items=Mismatch), sep=',') AS Mismatch,
            Mtime, Atime, Ctime
        FROM chain(a={
            SELECT OSPath, IsDir, UID, _u.User AS User, EUser,
            GID, Group, EGroup, Mode, EMode,
            join(array=enumerate(items=Mismatch), sep=',') AS Mismatch,
            Mtime, Atime, Ctime
            FROM _UIDFiltered
            GROUP BY OSPath
        }, b={
            SELECT OSPath, IsDir, UID, User, EUser, GID, _g.Group AS Group,
            EGroup, Mode, EMode,
            join(array=enumerate(items=Mismatch), sep=',') AS Mismatch,
            Mtime, Atime, Ctime
            FROM _GIDFiltered
            GROUP BY OSPath
        }, c={
            SELECT OSPath, IsDir, UID, User, EUser, GID, Group, EGroup, Mode, EMode,
            join(array=enumerate(items=Mismatch), sep=',') AS Mismatch,
            Mtime, Atime, Ctime
            FROM _FileModeFiltered
            GROUP BY OSPath
        }, d={
            SELECT OSPath, IsDir, UID, User, EUser, GID, Group, EGroup, Mode, EMode,
            join(array=enumerate(items=Mismatch), sep=',') AS Mismatch,
            Mtime, Atime, Ctime
            FROM _DirModeFiltered
            GROUP BY OSPath
        })
        GROUP BY OSPath
        ORDER BY OSPath

</code></pre><footer class=footline></footer></div></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=/js/clipboard.min.js?1740233288></script><script src=/js/perfect-scrollbar.min.js?1740233288></script><script src=/js/perfect-scrollbar.jquery.min.js?1740233288></script><script src=/js/jquery.sticky.js?1740233288></script><script src=/js/featherlight.min.js?1740233288></script><script src=/js/highlight.min.js?1740233288></script><script>hljs.highlightAll()</script><script src=/js/modernizr.custom-3.6.0.js?1740233288></script><script src=/js/learn.js?1740233288></script><script src=/js/hugo-learn.js?1740233288></script></body></html>