<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.139.4"><meta name=description content><link rel=icon href=/images/favicon.png type=image/png><title>Linux.Network.NM.Connections :: Velociraptor - Digging deeper!</title>
<link href=/css/nucleus.css?1740233288 rel=stylesheet><link href=/css/fontawesome-all.min.css?1740233288 rel=stylesheet><link href=/css/featherlight.min.css?1740233288 rel=stylesheet><link href=/css/perfect-scrollbar.min.css?1740233288 rel=stylesheet><link href=/css/auto-complete.css?1740233288 rel=stylesheet><link href=/css/theme.css?1740233288 rel=stylesheet><link href=/css/tabs.css?1740233288 rel=stylesheet><link href=/css/hugo-theme.css?1740233288 rel=stylesheet><link href=/css/theme-mine.css?1740233288 rel=stylesheet><link href=/css/dark.css?1740233288 rel=stylesheet><link href=/css/syntax.css?1740233288 rel=stylesheet><link href=/css/light.css?1740233288 rel=stylesheet><link href=/css/hljs.css?1740233288 rel=stylesheet><link href=https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css?1740233288 rel=stylesheet><script src=/js/jquery-3.3.1.min.js?1740233288></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style><script async src="https://www.googletagmanager.com/gtag/js?id=G-QYH72LMYCS"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-QYH72LMYCS")}</script><script></script></head><body data-url=/exchange/artifacts/pages/linux.network.nm.connections/><nav id=sidebar><div id=header-wrapper><div id=header><script>function darkmode(){$("body").addClass("dark").removeClass("light"),document.cookie="theme=darkmode;path=/"}function lightmode(){$("body").removeClass("dark").addClass("light"),document.cookie="theme=lightmode;path=/"}const regex=new RegExp("theme=darkmode");regex.test(document.cookie)?darkmode():lightmode()</script><div class="btn btn-default ThemeSelector darkmode" onclick=darkmode()><i class="fas fa-moon"></i></div><div class="btn btn-default ThemeSelector lightmode" onclick=lightmode()><i class="fas fa-sun"></i></div><a href=https://docs.velociraptor.app/><img src=https://docs.velociraptor.app//images/logo.svg></a></div></div><div class=highlightable><ul class=topics><li data-nav-id=https://docs.velociraptor.app/announcements/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/announcements/><i class="fas fa-bullhorn"></i>Announcements</a></div><ul><li data-nav-id=https://docs.velociraptor.app/announcements/advisories/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/announcements/advisories/><i class="fas fa-exclamation-triangle"></i>Security Advisories</a></div><ul><li data-nav-id=https://docs.velociraptor.app/announcements/advisories/cve-2024-10526/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/announcements/advisories/cve-2024-10526/>CVE-2024-10526</a></div></li><li data-nav-id=https://docs.velociraptor.app/announcements/advisories/cve-2023-5950/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/announcements/advisories/cve-2023-5950/>CVE-2023-5950</a></div></li><li data-nav-id=https://docs.velociraptor.app/announcements/advisories/cve-2023-2226/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/announcements/advisories/cve-2023-2226/>CVE-2023-2226</a></div></li><li data-nav-id=https://docs.velociraptor.app/announcements/advisories/cve-2023-0242/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/announcements/advisories/cve-2023-0242/>CVE-2023-0242</a></div></li><li data-nav-id=https://docs.velociraptor.app/announcements/advisories/cve-2023-0290/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/announcements/advisories/cve-2023-0290/>CVE-2023-0290</a></div></li></ul></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/><i class="fas fa-book-reader"></i>Documentation</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/overview/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/overview/>Velociraptor Overview</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/overview/history/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/overview/history/>History</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/overview/support/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/overview/support/>Support Policy</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/deployment/>Deployment</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/deployment/self-signed/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/self-signed/>Self-Signed SSL</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/cloud/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/deployment/cloud/>Cloud Deployment</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/deployment/cloud/multifrontend/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/cloud/multifrontend/>Multi-Frontend</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/orgs/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/orgs/>Organizations</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/clients/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/clients/>Deploying Clients</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/security/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/security/>Security</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/resources/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/resources/>Performance</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/troubleshooting/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/troubleshooting/>Troubleshooting</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/references/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/deployment/references/><i class="fas fa-book"></i>Config Reference</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/deployment/references/_reference/ class=dd-item><div><a href=/docs/deployment/references/_reference/></a></div></li></ul></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/gui/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/gui/>The Admin GUI</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/clients/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/clients/>Managing Clients</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/clients/searching/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/clients/searching/>Searching for clients</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/clients/interrogation/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/clients/interrogation/>Interrogation</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/clients/artifacts/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/clients/artifacts/>Collecting Artifacts</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/clients/labels/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/clients/labels/>Labels</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/clients/metadata/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/clients/metadata/>Metadata</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/clients/quarantine/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/clients/quarantine/>Quarantine</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/clients/vfs/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/clients/vfs/>Virtual File System</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/clients/shell/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/clients/shell/>Shell Commands</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/clients/monitoring/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/clients/monitoring/>Monitoring</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/clients/troubleshooting/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/clients/troubleshooting/>Troubleshooting</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/vql/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/vql/>VQL</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/vql/fundamentals/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/vql/fundamentals/>VQL Fundamentals</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/vql/events/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/vql/events/>Event Queries</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/vql/join/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/vql/join/>JOIN in VQL</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/vql/extending_vql/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/vql/extending_vql/>Extending VQL</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/vql/vql_reference/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/vql/vql_reference/><i class="fas fa-book"></i>VQL Reference</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/artifacts/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/artifacts/>Artifacts</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/artifacts/artifact_reference/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/artifacts/artifact_reference/><i class="fas fa-book"></i>Artifact Reference</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/artifacts/exchange_reference/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/artifacts/exchange_reference/><i class="fas fa-code"></i>Artifact Exchange</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/notebooks/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/notebooks/>Notebooks</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/hunting/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/hunting/>Hunting</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/forensic/>Forensic Analysis</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/forensic/filesystem/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/forensic/filesystem/>Searching Filenames</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/forensic/filesystem/paths/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/filesystem/paths/>Velociraptor Paths</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/filesystem/remapping/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/filesystem/remapping/>Remapping Accessors</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/searching/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/searching/>Searching Content</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/ntfs/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/ntfs/>NTFS Analysis</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/binary/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/binary/>Binary parsing</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/evidence_of_execution/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/evidence_of_execution/>Evidence Of Execution</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/event_logs/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/event_logs/>Event Logs</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/volatile/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/volatile/>Volatile State</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/offline_triage/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/offline_triage/>Triage and acquisition</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/offline_triage/remote_uploads/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/offline_triage/remote_uploads/>Remote Uploads</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/server_automation/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/server_automation/>Server Automation</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/server_automation/server_api/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/server_automation/server_api/>Server API</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/server_automation/server_monitoring/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/server_automation/server_monitoring/>Server Monitoring</a></div></li></ul></li></ul></li><li data-nav-id=https://docs.velociraptor.app/downloads/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/downloads/><i class="fas fa-download"></i>Downloads</a></div></li><hr><li data-nav-id=https://docs.velociraptor.app/vql_reference/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/vql_reference/><i class="fas fa-book"></i>VQL Reference</a></div><ul><li data-nav-id=https://docs.velociraptor.app/vql_reference/popular/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/popular/>Frequently Used ✨</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/windows/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/windows/>Windows-only</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/linux/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/linux/>Linux-only</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/server/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/server/>Server-only</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/parsers/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/parsers/>Parsers</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/encode/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/encode/>Encode/Decode</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/event/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/event/>Event Plugins</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/experimental/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/experimental/>Experimental</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/developer/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/developer/>Developer</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/other/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/other/>Other</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/accessors/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/accessors/>Accessors</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/training/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/training/><i class="fas fa-graduation-cap"></i>Training</a></div><ul><li data-nav-id=https://docs.velociraptor.app/training/playbooks/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/training/playbooks/><i class="fas fa-play"></i>Playbooks</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/blog/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/blog/><i class="fas fa-newspaper"></i>Blog</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/presentations/><i class="fas fa-chalkboard-teacher"></i>Presentations</a></div><ul><li data-nav-id=https://docs.velociraptor.app/presentations/2022_linuxconf_au/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2022_linuxconf_au/>Linux Conf Au 2022</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2022_auscert/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2022_auscert/>Auscert 2022</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2022_sans_summit/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2022_sans_summit/>SANS Summit 2022</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2022_velocon/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2022_velocon/>Velocon 2022</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2022_dfrws_apac/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2022_dfrws_apac/>DFRWS APAC 2022</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2023_everything_open/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2023_everything_open/>EverythingOpen 2023</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2023_velocon/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2023_velocon/>VeloCON 2023</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2024_auscert/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2024_auscert/>Auscert 2024</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2024_auscert-detection-engineering/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2024_auscert-detection-engineering/>Auscert 2024 Talk</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/exchange/ class="dd-item parent haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/exchange/><i class="fas fa-code"></i>Artifact Exchange</a></div></li><li data-nav-id=https://docs.velociraptor.app/artifact_references/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/artifact_references/><i class="fas fa-book"></i>Artifact Reference</a></div></li><li data-nav-id=https://docs.velociraptor.app/knowledge_base/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/knowledge_base/><i class="fas fa-brain"></i>Knowledge Base</a></div></li><li data-nav-id=https://docs.velociraptor.app/search/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/search/><i class='fas fa-search'></i>Search</a></div></li></ul><hr><section id=shortcuts><h3></h3><ul><li><a class=padding href=https://github.com/Velocidex/velociraptor><i class='fab fa-github'></i>Github</a></li><li><a class=padding href=https://docs.velociraptor.app/discord/><i class='fab fa-discord'></i>Discord</a></li><li><a class=padding href=https://docs.velociraptor.app/youtube/><i class='fab fa-youtube'></i>YouTube</a></li><li><a class=padding href=mailto:velociraptor-discuss@googlegroups.com><i class='fas fa-envelope'></i>Mailing List</a></li><li><a class=padding href=https://docs.velociraptor.app/rss/><i class='fas fa-rss'></i>RSS</a></li><li><a class=padding href=https://docs.rapid7.com/insightidr/velociraptor-integration/><i class='fa fa-question-circle'></i>Rapid7 Docs</a></li></ul></section><section id=footer><div class=footer-copyright>Brought to you by
<img src=/images/Rapid7_logo.svg class=rapid7><br><i class="fas fa-copyright"></i> 2024</div></section></div></nav><script>$("#sidebar i.fa-angle-right").each(function(){$(this).parent().parent().find("ul").hide()})</script><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=top-github-link><a class=github-link title='Edit this page' href=https://github.com/Velocidex/velociraptor-docs/edit/master/content/exchange/artifacts/Linux.Network.NM.Connections.yaml target=blank><i class="fas fa-code-branch"></i>
<span id=top-github-link-text>Edit this page</span></a></div><div id=breadcrumbs itemscope itemtype=http://schema.org/BreadcrumbList><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i>
</a></span><span id=toc-menu><i class="fas fa-list-alt"></i></span>
<span class=links itemprop=itemListElement itemscope itemtype=http://schema.org/ListItem><span itemprop=item><span itemprop=name>Linux.Network.NM.Connections</span></span>
<meta itemprop=position content="1"></span></div><div class=progress><div class=wrapper><nav id=TableOfContents></nav></div></div></div></div><div id=head-tags></div><div id=body-inner><h1>Linux.Network.NM.Connections</h1><p>NetworkManager is a popular high-level interface for configuring
networks in Linux systems, in particular Ubuntu and other Debian-based
flavours. This artifact lists the NetworkManager state, all configured
connections and their settings, as well as when the connections were
last activated. A list of BSSIDs per connection is also retrieved.</p><p>All the information is retrieved from NetworkManager configuration
files and other state files. Connection information is stored in
the /etc/NetworkManager/system-connections as long as the &ldquo;keyfile&rdquo;
plugin is selected in /etc/NetworkManager/NetworkManager.conf (this
is the default). Note that by default, NetworkManager doesn&rsquo;t manage
connections defined in /etc/network/interfaces.</p><p>Whether the connections are currently active is not stored in file
and must be queried using using nmcli or through dbus. This artifact
runs nmcli as an external program to retrieve this information.
Information such as IP addresses, routes, DNS servers, available Wi-Fi
networks and other settings will also be collected through nmcli.</p><p>This artifact also exports two functions, parse_ini(filename) and
parse_ini_as_dict(filename), which may be useful to parse INI files
in other artifacts.</p><pre><code class=language-yaml>
name: Linux.Network.NM.Connections
author: 'Andreas Misje - @misje'
description: |
  NetworkManager is a popular high-level interface for configuring
  networks in Linux systems, in particular Ubuntu and other Debian-based
  flavours. This artifact lists the NetworkManager state, all configured
  connections and their settings, as well as when the connections were
  last activated. A list of BSSIDs per connection is also retrieved.

  All the information is retrieved from NetworkManager configuration
  files and other state files. Connection information is stored in
  the /etc/NetworkManager/system-connections as long as the "keyfile"
  plugin is selected in /etc/NetworkManager/NetworkManager.conf (this
  is the default). Note that by default, NetworkManager doesn't manage
  connections defined in /etc/network/interfaces.

  Whether the connections are currently active is not stored in file
  and must be queried using using nmcli or through dbus. This artifact
  runs nmcli as an external program to retrieve this information.
  Information such as IP addresses, routes, DNS servers, available Wi-Fi
  networks and other settings will also be collected through nmcli.

  This artifact also exports two functions, parse_ini(filename) and
  parse_ini_as_dict(filename), which may be useful to parse INI files
  in other artifacts.

reference:
  - https://developer-old.gnome.org/NetworkManager/stable/nm-settings-keyfile.html
  - https://developer-old.gnome.org/NetworkManager/stable/settings-connection.html
  - https://developer-old.gnome.org/NetworkManager/stable/settings-802-11-wireless.html

type: CLIENT

required_permissions:
    - EXECVE

parameters:
  - name: RedactSecrets
    default: true
    type: bool
    description: |
        Replace Wi-FI PSKs (wifi-security/psk) with "\&lt;REDACTED\&gt;".

export: |
    /* Parse an INI config file and return Section (the part enclosed in '[]' on
       lines of their own), Key and Value. */
    LET parse_ini(filename) = SELECT * FROM foreach(row={
        SELECT * FROM parse_records_with_regex(file=filename,
            regex='''(?m)\[\s*(?P&lt;Section&gt;[^\]]+)\s*\](?P&lt;Contents&gt;[^\[]*)''')
        }, query={
            SELECT Section, Key, Value
                FROM parse_records_with_regex(file=Contents,
                    accessor='data',
                    regex='^[\s\n]*(?P&lt;Key&gt;[^=]+)=(?P&lt;Value&gt;.*)')
        })

    /* Parse an INI config file and return a single column, Contents, with
       the contents. Section names are prepended to keys, separated by '/'. */
    LET parse_ini_as_dict(filename) = SELECT to_dict(item={
            SELECT lowcase(string=Section + '/' + Key) AS _key, Value AS _value
            FROM parse_ini(filename=filename)
        }) AS Contents
        FROM scope()

column_types:
  - name: LastActivated
    type: timestamp
    description: |
        When the connection was last fully successfully activated. This
        timestamp may be updated periodically while the connection is active.

precondition: |
    SELECT OS FROM info() WHERE OS = 'linux'

sources:
  - name: State
    description: |
        NetworkManager have three states that may be toggled:
        NetworkingEnabled, which disables all networking (managed by
        NetworkManager); WirelessEnabled, which disables wireless networking;
        and WWANEnabled, which disables mobile data connections.
    query: |
        LET State_ = SELECT parse_string_with_regex(string=Data,
        regex=('''NetworkingEnabled=(?P&lt;NetworkingEnabled&gt;\S+)''',
            '''WirelessEnabled=(?P&lt;WirelessEnabled&gt;\S+)''',
            '''WWANEnabled=(?P&lt;WWANEnabled&gt;\S+)''')) AS Fields
        FROM read_file(filenames='/var/lib/NetworkManager/NetworkManager.state')

        LET State = SELECT Fields.NetworkingEnabled AS NetworkingEnabled,
            Fields.WirelessEnabled AS WirelessEnabled,
            Fields.WWANEnabled AS WWANEnabled
            FROM State_

        SELECT * FROM State

  - name: ConnectionConfigs
    description: |
        All connections configured in NetworkManager. Columns returned are
        OSPath and a dict with the connection configuration.
    query: |
        LET ConfiguredConnections &lt;= SELECT * FROM foreach(row={
            SELECT OSPath FROM glob(globs='/etc/NetworkManager/system-connections/*.nmconnection')
            }, query=if(condition=RedactSecrets, then={
                SELECT OSPath,
                    Contents + dict(`wifi-security/psk`='&lt;REDACTED&gt;')
                        AS Contents
                    FROM parse_ini_as_dict(filename=OSPath)
            }, else={
                SELECT *, OSPath FROM parse_ini_as_dict(filename=OSPath)
            })
        )

        SELECT OSPath, Contents FROM ConfiguredConnections

  - name: Connections
    description: |
        Return a handful of useful properties from ConnectionConfigs in a
        more readable table with individual column names: Name, UUID, Type,
        Device and LastActivated. LastActivated are fetched from another
        state file and combined with the results from ConnectionConfigs.
    query: |
        LET Timestamps = SELECT UUID, if(condition=parse_float(string=Timestamp),
            then=timestamp(epoch=Timestamp), else=null) AS Timestamp
            FROM parse_records_with_regex(file='/var/lib/NetworkManager/timestamps',
                regex='''(?P&lt;UUID&gt;[-A-Fa-f0-9]+)+=(?P&lt;Timestamp&gt;\S+)''')

        LET Connections &lt;= SELECT Name, _UUID AS UUID, Type, Device, LastActivated
            FROM foreach(row={
                SELECT * FROM ConfiguredConnections
                }, query={
                    SELECT Contents.`connection/id` AS Name,
                        Contents.`connection/uuid` AS _UUID,
                        Contents.`connection/type` AS Type,
                        Contents.`connection/interface-name` AS Device,
                        Timestamp AS LastActivated
                    FROM Timestamps
                    WHERE _UUID=UUID
            })

        SELECT * FROM Connections

  - name: ActiveConnections
    description: |
        Return connections from Connections that are currently active,
        by asking the NetworkManager daemon through the utility "nmcli".
    query: |
        LET nmcli = SELECT Stdout
            FROM execve(argv=['nmcli', '-t', '-f', 'uuid', 'connection', 'show', '--active'])

        LET ActiveConnections = SELECT * FROM foreach(row={
            SELECT * FROM parse_lines(accessor='data',
                filename=nmcli.Stdout)
            }, query={
                SELECT * FROM Connections WHERE UUID=Line
            })

        SELECT * FROM ActiveConnections

  - name: DeviceStatus
    description: |
        Ask NetworkManager through "nmcli" about the status of all network
        interfaces, managed as well unmanaged, with detailed information such
        as IP addresses, routes, MTU and DNS settings.
    query: |
        LET nmcli = SELECT Stdout
            FROM execve(argv=['nmcli', '-t', 'device', 'show'])

        LET DeviceStatus = SELECT * FROM foreach(row=split(sep='\n\n',
            string=nmcli.Stdout), query={
                SELECT parse_string_with_regex(string=_value,
                    regex='''GENERAL.DEVICE:(?P&lt;Device&gt;.+)''').Device AS Device,
                    to_dict(item={
                        SELECT Key AS _key, Value AS _value
                            FROM parse_records_with_regex(file=_value, accessor='data',
                                regex='^\n?(?P&lt;Key&gt;[^:]+):(?P&lt;Value&gt;.*)')
                    }) AS Status
                    FROM scope()
            })

        /* We're pretty much done now, but the output could be a lot nicer to
           work with. */

        LET S = scope()
        LET Status &lt;= SELECT * FROM foreach(row={SELECT * FROM DeviceStatus},
            column='Status')

        LET to_array(col, dev) = filter(list=array(a={
            SELECT * FROM column_filter(include=col, query={
                SELECT * FROM Status WHERE `GENERAL.DEVICE` = dev
            })}), condition='x=&gt;x')

        LET prettify_route(col, dev) = SELECT *
            FROM foreach(row=to_array(dev=dev, col=col), query={
                SELECT S.Dest AS Dest, S.NextHop AS NextHop, int(int=S.Metric) AS Metric
                FROM foreach(row={
                    SELECT parse_string_with_regex(string=S._value, regex=(
                        '''dst\s*=\s*(?P&lt;Dest&gt;[^,]+)''',
                        '''nh\s*=\s*(?P&lt;NextHop&gt;[^,]+)''',
                        '''mt\s*=\s*(?P&lt;Metric&gt;\d+)''')) AS R
                        FROM scope()
                    }, column='R')
                })
                WHERE Dest

        SELECT `GENERAL.DEVICE` AS Device,
            S.`GENERAL.TYPE` AS Type,
            S.`GENERAL.CONNECTION` AS Connection,
            S.`GENERAL.STATE` AS State,
            S.`GENERAL.HWADDR` AS Mac,
            S.`GENERAL.MTU` AS MTU,
            to_array(dev=`GENERAL.DEVICE`, col='IP4.ADDRESS') AS Addresses,
            prettify_route(dev=`GENERAL.DEVICE`, col='IP4.ROUTE') AS Routes,
            S.`IP4.GATEWAY` AS Gateway,
            to_array(dev=`GENERAL.DEVICE`, col='IP4.DNS') AS DNSServers,
            to_array(dev=`GENERAL.DEVICE`, col='IP4.DOMAIN') AS DNSDomains,
            to_array(dev=`GENERAL.DEVICE`, col='IP4.SEARCHES') AS DNSSearches,
            to_array(dev=`GENERAL.DEVICE`, col='IP6.ADDRESS') AS _IPv6Addresses,
            prettify_route(dev=`GENERAL.DEVICE`, col='IP6.ROUTE') AS _IPv6Routes,
            S.`IP6.GATEWAY` AS _IPv6Gateway,
            to_array(dev=`GENERAL.DEVICE`, col='IP6.DNS') AS _IPv6DNSServers,
            to_array(dev=`GENERAL.DEVICE`, col='IP6.DOMAIN') AS _IPv6DNSDomains,
            to_array(dev=`GENERAL.DEVICE`, col='IP6.SEARCHES') AS _IPv6DNSSearches
            FROM Status

  - name: AvailableAccessPoints
    description: |
        Ask NetworkManager through "nmcli" about details about all available
        Wi-Fi access points
    query: |
        LET nmcli = SELECT Stdout
            FROM execve(argv=['nmcli', '-t', '-m', 'multiline', '-f',
                'ssid,bssid,mode,chan,freq,rate,signal,security,wpa-flags,rsn-flags,device,active,in-use',
                'device', 'wifi', 'list'])

        LET AccessPoints = SELECT * FROM foreach(row=filter(list=split(sep='\x01\x02',
                /* Separate sections of key–values by injecting a blob and then
                   split on that string. nmcli also has a "tabular" output mode,
                   but ":", the separator, is also part of the output and is
                   "escaped" by "/", making the parsing difficult. */
                string=regex_replace(source=nmcli.Stdout, re='(?m)^IN-USE:.*$',
                    replace='$0\x01\x02')), regex='.'), query={

                SELECT to_dict(item={
                    SELECT Key AS _key, Value as _value FROM parse_records_with_regex(
                        file=_value, accessor='data', regex='^\n?(?P&lt;Key&gt;[^:]+):(?P&lt;Value&gt;.*)')
                }) AS Contents FROM scope() WHERE _value
            })
            WHERE Contents

        SELECT DEVICE AS Device, SSID, BSSID, MODE AS Mode, CHAN AS Chan,
            FREQ AS Freq, RATE AS Rate, SIGNAL AS Signal, SECURITY AS Security,
            ACTIVE='yes' AS Active, `WPA-FLAGS` AS WPAFlags, `RSN-FLAGS` AS RSNFlags,
            `IN-USE`='*' AS InUse
            FROM foreach(row=AccessPoints, column='Contents')

  - name: SeenBSSIDs
    description: |
        A list of BSSIDs (each BSSID formatted as a MAC address like
        "00:11:22:33:44:55") that have been detected as part of the Wi-Fi
        network. NetworkManager internally tracks previously seen BSSIDs.
    query: |
        LET SeenBSSIDs &lt;= SELECT UUID AS _UUID, filter(list=split(sep_string=',', string=BSSIDs),
            regex='.+') AS BSSIDs
            FROM parse_records_with_regex(file='/var/lib/NetworkManager/seen-bssids',
                regex='''(?P&lt;UUID&gt;[-A-Fa-f0-9]+)+=(?P&lt;BSSIDs&gt;\S+)''')

        SELECT * FROM foreach(row=SeenBSSIDs, query={
            SELECT Name, UUID, Device, BSSIDs FROM Connections
            WHERE _UUID=UUID
        })

</code></pre><footer class=footline></footer></div></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=/js/clipboard.min.js?1740233288></script><script src=/js/perfect-scrollbar.min.js?1740233288></script><script src=/js/perfect-scrollbar.jquery.min.js?1740233288></script><script src=/js/jquery.sticky.js?1740233288></script><script src=/js/featherlight.min.js?1740233288></script><script src=/js/highlight.min.js?1740233288></script><script>hljs.highlightAll()</script><script src=/js/modernizr.custom-3.6.0.js?1740233288></script><script src=/js/learn.js?1740233288></script><script src=/js/hugo-learn.js?1740233288></script></body></html>