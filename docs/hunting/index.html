<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.139.4"><meta name=description content><link rel=icon href=/images/favicon.png type=image/png><title>Hunting :: Velociraptor - Digging deeper!</title>
<link href=/css/nucleus.css?1740233287 rel=stylesheet><link href=/css/fontawesome-all.min.css?1740233287 rel=stylesheet><link href=/css/featherlight.min.css?1740233287 rel=stylesheet><link href=/css/perfect-scrollbar.min.css?1740233287 rel=stylesheet><link href=/css/auto-complete.css?1740233287 rel=stylesheet><link href=/css/theme.css?1740233287 rel=stylesheet><link href=/css/tabs.css?1740233287 rel=stylesheet><link href=/css/hugo-theme.css?1740233287 rel=stylesheet><link href=/css/theme-mine.css?1740233287 rel=stylesheet><link href=/css/dark.css?1740233287 rel=stylesheet><link href=/css/syntax.css?1740233287 rel=stylesheet><link href=/css/light.css?1740233287 rel=stylesheet><link href=/css/hljs.css?1740233287 rel=stylesheet><link href=https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css?1740233287 rel=stylesheet><script src=/js/jquery-3.3.1.min.js?1740233287></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style><script async src="https://www.googletagmanager.com/gtag/js?id=G-QYH72LMYCS"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-QYH72LMYCS")}</script><script></script></head><body data-url=/docs/hunting/><nav id=sidebar><div id=header-wrapper><div id=header><script>function darkmode(){$("body").addClass("dark").removeClass("light"),document.cookie="theme=darkmode;path=/"}function lightmode(){$("body").removeClass("dark").addClass("light"),document.cookie="theme=lightmode;path=/"}const regex=new RegExp("theme=darkmode");regex.test(document.cookie)?darkmode():lightmode()</script><div class="btn btn-default ThemeSelector darkmode" onclick=darkmode()><i class="fas fa-moon"></i></div><div class="btn btn-default ThemeSelector lightmode" onclick=lightmode()><i class="fas fa-sun"></i></div><a href=https://docs.velociraptor.app/><img src=https://docs.velociraptor.app//images/logo.svg></a></div></div><div class=highlightable><ul class=topics><li data-nav-id=https://docs.velociraptor.app/announcements/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/announcements/><i class="fas fa-bullhorn"></i>Announcements</a></div><ul><li data-nav-id=https://docs.velociraptor.app/announcements/advisories/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/announcements/advisories/><i class="fas fa-exclamation-triangle"></i>Security Advisories</a></div><ul><li data-nav-id=https://docs.velociraptor.app/announcements/advisories/cve-2024-10526/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/announcements/advisories/cve-2024-10526/>CVE-2024-10526</a></div></li><li data-nav-id=https://docs.velociraptor.app/announcements/advisories/cve-2023-5950/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/announcements/advisories/cve-2023-5950/>CVE-2023-5950</a></div></li><li data-nav-id=https://docs.velociraptor.app/announcements/advisories/cve-2023-2226/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/announcements/advisories/cve-2023-2226/>CVE-2023-2226</a></div></li><li data-nav-id=https://docs.velociraptor.app/announcements/advisories/cve-2023-0242/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/announcements/advisories/cve-2023-0242/>CVE-2023-0242</a></div></li><li data-nav-id=https://docs.velociraptor.app/announcements/advisories/cve-2023-0290/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/announcements/advisories/cve-2023-0290/>CVE-2023-0290</a></div></li></ul></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/ class="dd-item parent haschildren"><div><i class="fa fa-angle-down fa-sm category-icon"></i>
<a href=/docs/><i class="fas fa-book-reader"></i>Documentation</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/overview/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/overview/>Velociraptor Overview</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/overview/history/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/overview/history/>History</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/overview/support/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/overview/support/>Support Policy</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/deployment/>Deployment</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/deployment/self-signed/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/self-signed/>Self-Signed SSL</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/cloud/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/deployment/cloud/>Cloud Deployment</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/deployment/cloud/multifrontend/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/cloud/multifrontend/>Multi-Frontend</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/orgs/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/orgs/>Organizations</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/clients/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/clients/>Deploying Clients</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/security/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/security/>Security</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/resources/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/resources/>Performance</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/troubleshooting/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/troubleshooting/>Troubleshooting</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/references/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/deployment/references/><i class="fas fa-book"></i>Config Reference</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/deployment/references/_reference/ class=dd-item><div><a href=/docs/deployment/references/_reference/></a></div></li></ul></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/gui/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/gui/>The Admin GUI</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/clients/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/clients/>Managing Clients</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/clients/searching/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/clients/searching/>Searching for clients</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/clients/interrogation/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/clients/interrogation/>Interrogation</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/clients/artifacts/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/clients/artifacts/>Collecting Artifacts</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/clients/labels/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/clients/labels/>Labels</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/clients/metadata/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/clients/metadata/>Metadata</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/clients/quarantine/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/clients/quarantine/>Quarantine</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/clients/vfs/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/clients/vfs/>Virtual File System</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/clients/shell/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/clients/shell/>Shell Commands</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/clients/monitoring/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/clients/monitoring/>Monitoring</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/clients/troubleshooting/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/clients/troubleshooting/>Troubleshooting</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/vql/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/vql/>VQL</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/vql/fundamentals/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/vql/fundamentals/>VQL Fundamentals</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/vql/events/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/vql/events/>Event Queries</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/vql/join/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/vql/join/>JOIN in VQL</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/vql/extending_vql/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/vql/extending_vql/>Extending VQL</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/vql/vql_reference/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/vql/vql_reference/><i class="fas fa-book"></i>VQL Reference</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/artifacts/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/artifacts/>Artifacts</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/artifacts/artifact_reference/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/artifacts/artifact_reference/><i class="fas fa-book"></i>Artifact Reference</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/artifacts/exchange_reference/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/artifacts/exchange_reference/><i class="fas fa-code"></i>Artifact Exchange</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/notebooks/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/notebooks/>Notebooks</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/hunting/ class="dd-item active"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/hunting/>Hunting</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/forensic/>Forensic Analysis</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/forensic/filesystem/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/forensic/filesystem/>Searching Filenames</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/forensic/filesystem/paths/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/filesystem/paths/>Velociraptor Paths</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/filesystem/remapping/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/filesystem/remapping/>Remapping Accessors</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/searching/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/searching/>Searching Content</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/ntfs/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/ntfs/>NTFS Analysis</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/binary/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/binary/>Binary parsing</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/evidence_of_execution/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/evidence_of_execution/>Evidence Of Execution</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/event_logs/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/event_logs/>Event Logs</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/volatile/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/volatile/>Volatile State</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/offline_triage/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/offline_triage/>Triage and acquisition</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/offline_triage/remote_uploads/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/offline_triage/remote_uploads/>Remote Uploads</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/server_automation/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/server_automation/>Server Automation</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/server_automation/server_api/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/server_automation/server_api/>Server API</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/server_automation/server_monitoring/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/server_automation/server_monitoring/>Server Monitoring</a></div></li></ul></li></ul></li><li data-nav-id=https://docs.velociraptor.app/downloads/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/downloads/><i class="fas fa-download"></i>Downloads</a></div></li><hr><li data-nav-id=https://docs.velociraptor.app/vql_reference/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/vql_reference/><i class="fas fa-book"></i>VQL Reference</a></div><ul><li data-nav-id=https://docs.velociraptor.app/vql_reference/popular/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/popular/>Frequently Used âœ¨</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/windows/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/windows/>Windows-only</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/linux/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/linux/>Linux-only</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/server/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/server/>Server-only</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/parsers/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/parsers/>Parsers</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/encode/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/encode/>Encode/Decode</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/event/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/event/>Event Plugins</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/experimental/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/experimental/>Experimental</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/developer/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/developer/>Developer</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/other/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/other/>Other</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/accessors/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/accessors/>Accessors</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/training/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/training/><i class="fas fa-graduation-cap"></i>Training</a></div><ul><li data-nav-id=https://docs.velociraptor.app/training/playbooks/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/training/playbooks/><i class="fas fa-play"></i>Playbooks</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/blog/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/blog/><i class="fas fa-newspaper"></i>Blog</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/presentations/><i class="fas fa-chalkboard-teacher"></i>Presentations</a></div><ul><li data-nav-id=https://docs.velociraptor.app/presentations/2022_linuxconf_au/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2022_linuxconf_au/>Linux Conf Au 2022</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2022_auscert/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2022_auscert/>Auscert 2022</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2022_sans_summit/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2022_sans_summit/>SANS Summit 2022</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2022_velocon/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2022_velocon/>Velocon 2022</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2022_dfrws_apac/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2022_dfrws_apac/>DFRWS APAC 2022</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2023_everything_open/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2023_everything_open/>EverythingOpen 2023</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2023_velocon/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2023_velocon/>VeloCON 2023</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2024_auscert/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2024_auscert/>Auscert 2024</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2024_auscert-detection-engineering/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2024_auscert-detection-engineering/>Auscert 2024 Talk</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/exchange/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/exchange/><i class="fas fa-code"></i>Artifact Exchange</a></div></li><li data-nav-id=https://docs.velociraptor.app/artifact_references/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/artifact_references/><i class="fas fa-book"></i>Artifact Reference</a></div></li><li data-nav-id=https://docs.velociraptor.app/knowledge_base/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/knowledge_base/><i class="fas fa-brain"></i>Knowledge Base</a></div></li><li data-nav-id=https://docs.velociraptor.app/search/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/search/><i class='fas fa-search'></i>Search</a></div></li></ul><hr><section id=shortcuts><h3></h3><ul><li><a class=padding href=https://github.com/Velocidex/velociraptor><i class='fab fa-github'></i>Github</a></li><li><a class=padding href=https://docs.velociraptor.app/discord/><i class='fab fa-discord'></i>Discord</a></li><li><a class=padding href=https://docs.velociraptor.app/youtube/><i class='fab fa-youtube'></i>YouTube</a></li><li><a class=padding href=mailto:velociraptor-discuss@googlegroups.com><i class='fas fa-envelope'></i>Mailing List</a></li><li><a class=padding href=https://docs.velociraptor.app/rss/><i class='fas fa-rss'></i>RSS</a></li><li><a class=padding href=https://docs.rapid7.com/insightidr/velociraptor-integration/><i class='fa fa-question-circle'></i>Rapid7 Docs</a></li></ul></section><section id=footer><div class=footer-copyright>Brought to you by
<img src=/images/Rapid7_logo.svg class=rapid7><br><i class="fas fa-copyright"></i> 2024</div></section></div></nav><script>$("#sidebar i.fa-angle-right").each(function(){$(this).parent().parent().find("ul").hide()})</script><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=top-github-link><a class=github-link title='Edit this page' href=https://github.com/Velocidex/velociraptor-docs/edit/master/content/docs/hunting/_index.md target=blank><i class="fas fa-code-branch"></i>
<span id=top-github-link-text>Edit this page</span></a></div><div id=breadcrumbs itemscope itemtype=http://schema.org/BreadcrumbList><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i>
</a></span><span id=toc-menu><i class="fas fa-list-alt"></i></span>
<span class=links itemprop=itemListElement itemscope itemtype=http://schema.org/ListItem><span itemprop=item><span itemprop=name>Hunting</span></span>
<meta itemprop=position content="1"></span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><a href=#what-is-a-hunt>What is a hunt?</a></li><li><a href=#schedule-a-new-hunt>Schedule a new hunt</a></li><li><a href=#post-process-a-hunt>Post-process a hunt</a></li><li><a href=#hunts-and-labels>Hunts and labels</a></li><li><a href=#manually-adding-clients-to-hunts>Manually adding clients to hunts</a></li></ul></nav></div></div></div></div><div id=head-tags></div><div id=body-inner><h1>Hunting</h1><p>With Velociraptor, you can collect the same artifact from multiple
endpoints at the same time using a <strong>Hunt</strong>. Hunts allow you to do the
following:</p><ul><li><p>Monitor offline endpoints by scheduling hunts collecting artifacts
from any endpoints that come back online during a certain period.</p></li><li><p>Examine the results from all collections easily.</p></li><li><p>Keep track of which endpoints collected the artifact and make sure
the same artifact is not collected more than once on any endpoint.</p></li></ul><h2 id=what-is-a-hunt>What is a hunt?</h2><p>A hunt is a logical collection of a one or more artifacts from a group
of systems. The <strong>Hunt Manager</strong> is a Velociraptor component that is
responsible for scheduling collections of clients that met certain
criteria, then keep track of these collections inside the hunt.</p><p>The important takeaway from this is that artifacts are still collected
from endpoints the same way as we did previously, it is simply
automated using the hunt manager.</p><h2 id=schedule-a-new-hunt>Schedule a new hunt</h2><p>To schedule a new hunt, select the <strong>Hunt Manager</strong> <i class="fas
fa-crosshairs"></i> from the sidebar and then select <strong>New Hunt</strong> button
<i class="fas fa-plus"></i> to see the <strong>New Hunt Wizard</strong>.</p><p>Provide the hunt with a description and set the expiration date. You
can also target machines containing the same label (A <strong>Label Group</strong>),
or exclude the hunt from these machines.</p><p><figure id=0d8aaeb5ce56e7dc06491230e63d7908><div data-featherlight=#0d8aaeb5ce56e7dc06491230e63d7908 class=figure><img src=image89.png alt="New Hunt"></div><figcaption><a class=image-link href=image89.png><i class="fa fa-download"></i></a>
New Hunt</figcaption></figure></p><div class="mynotices note"><div heading=" Hunts and expiry "><p>Hunts do not complete - they expire! The total number of clients in
any real network is not known in advance because new clients can
appear at any time as hosts get provisioned, return from vacation, or
get switched on. Therefore it does not make sense to think of a hunt
as done. As new clients are discovered, the hunt is applied to them.</p><p>It is only when the hunt expires that new clients no longer receive
the hunt. Note that each client can only receive the hunt once.</p></div></div><p>Next you need to select and configure the artifacts as before. Once
everything is set, click <strong>Launch Hunt</strong> to create a new hunt.</p><p>Hunts are always created in the <code>Paused</code> state so you will need to
click the <strong>Start</strong> button before they commence. Once
a hunt is started many hundreds of machines will begin collecting that
artifact, be sure to test artifact on one or two endpoints
first.</p><p><figure id=c9509f1e88b25ddda77e092b08501b23><div data-featherlight=#c9509f1e88b25ddda77e092b08501b23 class=figure><img src=image90.png alt="Start Hunt"></div><figcaption><a class=image-link href=image90.png><i class="fa fa-download"></i></a>
Start Hunt</figcaption></figure></p><p>You can monitor the hunt&rsquo;s progress. As clients are scheduled
they will begin their collection. After a while the results are sent
back and the clients complete.</p><p><figure id=cb6c6444594efe6bfbe188cf82dbcd03><div data-featherlight=#cb6c6444594efe6bfbe188cf82dbcd03 class=figure><img src=image92.png alt="Monitoring hunt progress"></div><figcaption><a class=image-link href=image92.png><i class="fa fa-download"></i></a>
Monitoring hunt progress</figcaption></figure></p><h2 id=post-process-a-hunt>Post-process a hunt</h2><p>After collecting an artifact from many hosts in a hunt, we often need
to post-process the results to identify the results that are
important.</p><p>Velociraptor creates a notebook for each hunt where you can apply a
VQL query to the results.</p><p>Let&rsquo;s consider our earlier example collecting the scheduled tasks from
all endpoints. Suppose we wanted to only see those machines with a scheduled task that runs a batch script from cmd.exe and count
only unique occurrences of this command.</p><p>We can update the notebook&rsquo;s VQL with a <code>WHERE</code> clause and <code>GROUP BY</code>
to post-process the results.</p><p><figure id=49ce7cd649924cdc25c63b9db6011b4a><div data-featherlight=#49ce7cd649924cdc25c63b9db6011b4a class=figure><img src=image95.png alt="Post Processing"></div><figcaption><a class=image-link href=image95.png><i class="fa fa-download"></i></a>
Post Processing</figcaption></figure></p><div class="mynotices warning"><div heading=" Managing hunt data volumes "><p>When hunting large numbers of endpoints, data grows quickly. Even
uploading a moderately sized file can add up very quickly. For example,
collecting a 100Mb file from 10,000 machines results in over 1Tb of
required storage.</p><p>Be mindful of how much data you will be uploading in total. It is
always best to use more targeted artifacts that return a few rows per
endpoint rather than fetch raw files that need to be parsed offline.</p></div></div><h2 id=hunts-and-labels>Hunts and labels</h2><p>We have seen above that we can target hunts by labels. When a hunt is
targeted to a label, only hosts that have the label assigned will be
automatically scheduled by the hunt manager.</p><p>This allows you to dynamically apply the hunt to various hosts by
simply adding labels to them. This workflow is very powerful as it
allows for incremental triaging.</p><p>Lets consider an example for how this can be applied in practice.</p><p><figure id=e008317e956e3dc4457c36469ab42adb><div data-featherlight=#e008317e956e3dc4457c36469ab42adb class=figure><img src=incremental_hunting_by_label_1.png alt="Schedule hunt by label"></div><figcaption><a class=image-link href=incremental_hunting_by_label_1.png><i class="fa fa-download"></i></a>
Schedule hunt by label</figcaption></figure></p><p>I start the process by setting up a hunt for preserving the event logs
from clients which I consider to have been compromised. Since this
hunt will collect a lot of data, I can not really run it across the
entire network - instead I will be very selective and only schedule it
on compromised hosts.</p><ol><li>I add a description for this hunt</li><li>Next I select to Match by Label.</li><li>I can search for an existing label, or if no label already exists,
I can create a new label. In this case I will choose the new label
<code>Preserve</code> to denote a host I want to preserve.</li></ol><p>For this example, I choose the <code>Windows.KapeFiles.Targets</code> artifact
with the <code>Eventlogs</code> target to collect all windows event logs for
preservation.</p><p><figure id=822e6c01b64b5a1d3d78b471470699db><div data-featherlight=#822e6c01b64b5a1d3d78b471470699db class=figure><img src=incremental_hunting_by_label_2.png alt="Collect for preservation"></div><figcaption><a class=image-link href=incremental_hunting_by_label_2.png><i class="fa fa-download"></i></a>
Collect for preservation</figcaption></figure></p><p>The hunt is started but since there are no clients with the new label
yet, no clients are scheduled.</p><p><figure id=a5af6f43d1fdb71a4f68b217208cd02d><div data-featherlight=#a5af6f43d1fdb71a4f68b217208cd02d class=figure><img src=incremental_hunting_by_label_3.png alt="Waiting for clients"></div><figcaption><a class=image-link href=incremental_hunting_by_label_3.png><i class="fa fa-download"></i></a>
Waiting for clients</figcaption></figure></p><p>I carry on with my investigation, and at some point I find a client
which I believe is compromised! I simply go to the host overview page
and label this client.</p><p><figure id=aa3371eecb2a7a7e282072e307678b82><div data-featherlight=#aa3371eecb2a7a7e282072e307678b82 class=figure><img src=incremental_hunting_by_label_4.png alt="Labeling clients"></div><figcaption><a class=image-link href=incremental_hunting_by_label_4.png><i class="fa fa-download"></i></a>
Labeling clients</figcaption></figure></p><p>The act of labeling the client has automatically scheduled the client
into the hunt.</p><p><figure id=31e8981ce675fe88eeb7d3defc0b1232><div data-featherlight=#31e8981ce675fe88eeb7d3defc0b1232 class=figure><img src=incremental_hunting_by_label_5.png alt="Client is scheduled"></div><figcaption><a class=image-link href=incremental_hunting_by_label_5.png><i class="fa fa-download"></i></a>
Client is scheduled</figcaption></figure></p><p>Note that I can use this technique to automatically schedule clients
into various hunts using the VQL
<a href=/vql_reference/server/label/>label()</a>
function. Therefore I can use
this technique to automatically add clients to various hunts based on
previous findings.</p><h2 id=manually-adding-clients-to-hunts>Manually adding clients to hunts</h2><p>You can think of hunts as a group of collections that we can inspect
together. For example we can see all the processes from all clients by
collecting the <code>Windows.System.Pslist</code> artifact across the entire
network in a hunt. Then we can filter across all the processes with
VQL:</p><pre><code class=language-vql>SELECT * FROM hunt_results(hunt_id=&quot;H.123&quot;, artifact=&quot;Windows.System.Pslist&quot;)
</code></pre><p>This is very convenient - hunts are really a way to group related
collections together.</p><p>Normally the <strong>Hunt Manager</strong> component described above is responsible
for scheduling collections on clients depending on certain conditions
(e.g. labels or OS matches), and adding them to the hunt. However the
scheduling step is a different separate step from adding the
collection to the hunt.</p><p>It is possible to schedule the collection manually and <em><strong>then</strong></em> also
add the collection to the hunt. This method gives the ultimate
flexibility in managing hunt membership.</p><p>A common example is when a collection needs to be redone for some
reason. Normally the hunt manager ensures only a single collection
from the hunt is scheduled on the same client. However sometimes the
collection fails, or simply needs to be recollected for fresher
data to be added to the hunt.</p><p>In the above example, I redo the collection of
<code>Windows.KapeFiles.Targets</code> that the hunt scheduled previously by
navigating to the collection view in that specific client. Then I
<strong>Copy</strong> the collection by pressing the <i class="fas fa-copy"></i>
button. I can now update things like, timeout or change the parameters
a bit as required.</p><p><figure id=2185311c44329aeefdc984a2cb768154><div data-featherlight=#2185311c44329aeefdc984a2cb768154 class=figure><img src=manual_hunt_1.png alt="Manually rescheduling a collection"></div><figcaption><a class=image-link href=manual_hunt_1.png><i class="fa fa-download"></i></a>
Manually rescheduling a collection</figcaption></figure></p><p>Next, I add the collection to the hunt by clicking the <strong>Add to Hunt</strong> <i class="fas
fa-crosshairs"></i> button.</p><p><figure id=97b2907ff7ac7d39f3271a7783f80dbb><div data-featherlight=#97b2907ff7ac7d39f3271a7783f80dbb class=figure><img src=manual_hunt_2.png alt="Add collection to hunt"></div><figcaption><a class=image-link href=manual_hunt_2.png><i class="fa fa-download"></i></a>
Add collection to hunt</figcaption></figure></p><p>The new collection is added to the hunt. It is up to you if you want
to keep the old collection around or just delete it.</p><p><figure id=d0dc80d39471e25ed65cf9a530d7ebb3><div data-featherlight=#d0dc80d39471e25ed65cf9a530d7ebb3 class=figure><img src=manual_hunt_3.png alt="Hunt with additional collection"></div><figcaption><a class=image-link href=manual_hunt_3.png><i class="fa fa-download"></i></a>
Hunt with additional collection</figcaption></figure></p><p>You can add collections to a hunt using the
<a href=/vql_reference/server/hunt_add/>hunt_add()</a>
VQL function which
allows unlimited automation around which flows are added to hunt (and
can also automate the relaunching of the collections).</p><p>To help you with manipulating hunts with the notebook, hunt notebooks
offer a <strong>Cell Suggestion</strong> to assist with managing the hunt progress.</p><p><figure id=578376d78adb00123f853c854a3b179b><div data-featherlight=#578376d78adb00123f853c854a3b179b class=figure><img src=hunt_suggestion_1.png alt="Adding a Hunt Progress cell suggestion"></div><figcaption><a class=image-link href=hunt_suggestion_1.png><i class="fa fa-download"></i></a>
Adding a Hunt Progress cell suggestion</figcaption></figure></p><p><figure id=7899febe417739dde16a537a11b8cffb><div data-featherlight=#7899febe417739dde16a537a11b8cffb class=figure><img src=hunt_suggestion_2.png alt="Helpful VQL queries"></div><figcaption><a class=image-link href=hunt_suggestion_2.png><i class="fa fa-download"></i></a>
Helpful VQL queries</figcaption></figure></p><footer class=footline></footer></div></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=/js/clipboard.min.js?1740233287></script><script src=/js/perfect-scrollbar.min.js?1740233287></script><script src=/js/perfect-scrollbar.jquery.min.js?1740233287></script><script src=/js/jquery.sticky.js?1740233287></script><script src=/js/featherlight.min.js?1740233287></script><script src=/js/highlight.min.js?1740233287></script><script>hljs.highlightAll()</script><script src=/js/modernizr.custom-3.6.0.js?1740233287></script><script src=/js/learn.js?1740233287></script><script src=/js/hugo-learn.js?1740233287></script></body></html>