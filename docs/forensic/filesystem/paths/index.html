<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.139.4"><meta name=description content="In DFIR we often talk about paths and filesystems. However, these are usually more complex than they appear.
"><link rel=icon href=/images/favicon.png type=image/png><title>Velociraptor Paths :: Velociraptor - Digging deeper!</title>
<link href=/css/nucleus.css?1740233287 rel=stylesheet><link href=/css/fontawesome-all.min.css?1740233287 rel=stylesheet><link href=/css/featherlight.min.css?1740233287 rel=stylesheet><link href=/css/perfect-scrollbar.min.css?1740233287 rel=stylesheet><link href=/css/auto-complete.css?1740233287 rel=stylesheet><link href=/css/theme.css?1740233287 rel=stylesheet><link href=/css/tabs.css?1740233287 rel=stylesheet><link href=/css/hugo-theme.css?1740233287 rel=stylesheet><link href=/css/theme-mine.css?1740233287 rel=stylesheet><link href=/css/dark.css?1740233287 rel=stylesheet><link href=/css/syntax.css?1740233287 rel=stylesheet><link href=/css/light.css?1740233287 rel=stylesheet><link href=/css/hljs.css?1740233287 rel=stylesheet><link href=https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css?1740233287 rel=stylesheet><script src=/js/jquery-3.3.1.min.js?1740233287></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style><script async src="https://www.googletagmanager.com/gtag/js?id=G-QYH72LMYCS"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-QYH72LMYCS")}</script><script></script></head><body data-url=/docs/forensic/filesystem/paths/><nav id=sidebar><div id=header-wrapper><div id=header><script>function darkmode(){$("body").addClass("dark").removeClass("light"),document.cookie="theme=darkmode;path=/"}function lightmode(){$("body").removeClass("dark").addClass("light"),document.cookie="theme=lightmode;path=/"}const regex=new RegExp("theme=darkmode");regex.test(document.cookie)?darkmode():lightmode()</script><div class="btn btn-default ThemeSelector darkmode" onclick=darkmode()><i class="fas fa-moon"></i></div><div class="btn btn-default ThemeSelector lightmode" onclick=lightmode()><i class="fas fa-sun"></i></div><a href=https://docs.velociraptor.app/><img src=https://docs.velociraptor.app//images/logo.svg></a></div></div><div class=highlightable><ul class=topics><li data-nav-id=https://docs.velociraptor.app/announcements/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/announcements/><i class="fas fa-bullhorn"></i>Announcements</a></div><ul><li data-nav-id=https://docs.velociraptor.app/announcements/advisories/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/announcements/advisories/><i class="fas fa-exclamation-triangle"></i>Security Advisories</a></div><ul><li data-nav-id=https://docs.velociraptor.app/announcements/advisories/cve-2024-10526/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/announcements/advisories/cve-2024-10526/>CVE-2024-10526</a></div></li><li data-nav-id=https://docs.velociraptor.app/announcements/advisories/cve-2023-5950/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/announcements/advisories/cve-2023-5950/>CVE-2023-5950</a></div></li><li data-nav-id=https://docs.velociraptor.app/announcements/advisories/cve-2023-2226/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/announcements/advisories/cve-2023-2226/>CVE-2023-2226</a></div></li><li data-nav-id=https://docs.velociraptor.app/announcements/advisories/cve-2023-0242/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/announcements/advisories/cve-2023-0242/>CVE-2023-0242</a></div></li><li data-nav-id=https://docs.velociraptor.app/announcements/advisories/cve-2023-0290/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/announcements/advisories/cve-2023-0290/>CVE-2023-0290</a></div></li></ul></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/ class="dd-item parent haschildren"><div><i class="fa fa-angle-down fa-sm category-icon"></i>
<a href=/docs/><i class="fas fa-book-reader"></i>Documentation</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/overview/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/overview/>Velociraptor Overview</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/overview/history/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/overview/history/>History</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/overview/support/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/overview/support/>Support Policy</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/deployment/>Deployment</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/deployment/self-signed/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/self-signed/>Self-Signed SSL</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/cloud/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/deployment/cloud/>Cloud Deployment</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/deployment/cloud/multifrontend/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/cloud/multifrontend/>Multi-Frontend</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/orgs/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/orgs/>Organizations</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/clients/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/clients/>Deploying Clients</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/security/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/security/>Security</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/resources/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/resources/>Performance</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/troubleshooting/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/troubleshooting/>Troubleshooting</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/references/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/deployment/references/><i class="fas fa-book"></i>Config Reference</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/deployment/references/_reference/ class=dd-item><div><a href=/docs/deployment/references/_reference/></a></div></li></ul></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/gui/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/gui/>The Admin GUI</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/clients/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/clients/>Managing Clients</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/clients/searching/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/clients/searching/>Searching for clients</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/clients/interrogation/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/clients/interrogation/>Interrogation</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/clients/artifacts/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/clients/artifacts/>Collecting Artifacts</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/clients/labels/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/clients/labels/>Labels</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/clients/metadata/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/clients/metadata/>Metadata</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/clients/quarantine/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/clients/quarantine/>Quarantine</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/clients/vfs/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/clients/vfs/>Virtual File System</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/clients/shell/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/clients/shell/>Shell Commands</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/clients/monitoring/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/clients/monitoring/>Monitoring</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/clients/troubleshooting/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/clients/troubleshooting/>Troubleshooting</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/vql/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/vql/>VQL</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/vql/fundamentals/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/vql/fundamentals/>VQL Fundamentals</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/vql/events/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/vql/events/>Event Queries</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/vql/join/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/vql/join/>JOIN in VQL</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/vql/extending_vql/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/vql/extending_vql/>Extending VQL</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/vql/vql_reference/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/vql/vql_reference/><i class="fas fa-book"></i>VQL Reference</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/artifacts/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/artifacts/>Artifacts</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/artifacts/artifact_reference/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/artifacts/artifact_reference/><i class="fas fa-book"></i>Artifact Reference</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/artifacts/exchange_reference/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/artifacts/exchange_reference/><i class="fas fa-code"></i>Artifact Exchange</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/notebooks/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/notebooks/>Notebooks</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/hunting/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/hunting/>Hunting</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/ class="dd-item parent haschildren"><div><i class="fa fa-angle-down fa-sm category-icon"></i>
<a href=/docs/forensic/>Forensic Analysis</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/forensic/filesystem/ class="dd-item parent haschildren"><div><i class="fa fa-angle-down fa-sm category-icon"></i>
<a href=/docs/forensic/filesystem/>Searching Filenames</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/forensic/filesystem/paths/ class="dd-item active"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/filesystem/paths/>Velociraptor Paths</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/filesystem/remapping/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/filesystem/remapping/>Remapping Accessors</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/searching/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/searching/>Searching Content</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/ntfs/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/ntfs/>NTFS Analysis</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/binary/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/binary/>Binary parsing</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/evidence_of_execution/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/evidence_of_execution/>Evidence Of Execution</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/event_logs/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/event_logs/>Event Logs</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/volatile/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/volatile/>Volatile State</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/offline_triage/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/offline_triage/>Triage and acquisition</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/offline_triage/remote_uploads/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/offline_triage/remote_uploads/>Remote Uploads</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/server_automation/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/server_automation/>Server Automation</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/server_automation/server_api/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/server_automation/server_api/>Server API</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/server_automation/server_monitoring/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/server_automation/server_monitoring/>Server Monitoring</a></div></li></ul></li></ul></li><li data-nav-id=https://docs.velociraptor.app/downloads/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/downloads/><i class="fas fa-download"></i>Downloads</a></div></li><hr><li data-nav-id=https://docs.velociraptor.app/vql_reference/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/vql_reference/><i class="fas fa-book"></i>VQL Reference</a></div><ul><li data-nav-id=https://docs.velociraptor.app/vql_reference/popular/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/popular/>Frequently Used âœ¨</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/windows/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/windows/>Windows-only</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/linux/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/linux/>Linux-only</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/server/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/server/>Server-only</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/parsers/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/parsers/>Parsers</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/encode/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/encode/>Encode/Decode</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/event/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/event/>Event Plugins</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/experimental/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/experimental/>Experimental</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/developer/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/developer/>Developer</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/other/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/other/>Other</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/accessors/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/accessors/>Accessors</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/training/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/training/><i class="fas fa-graduation-cap"></i>Training</a></div><ul><li data-nav-id=https://docs.velociraptor.app/training/playbooks/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/training/playbooks/><i class="fas fa-play"></i>Playbooks</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/blog/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/blog/><i class="fas fa-newspaper"></i>Blog</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/presentations/><i class="fas fa-chalkboard-teacher"></i>Presentations</a></div><ul><li data-nav-id=https://docs.velociraptor.app/presentations/2022_linuxconf_au/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2022_linuxconf_au/>Linux Conf Au 2022</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2022_auscert/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2022_auscert/>Auscert 2022</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2022_sans_summit/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2022_sans_summit/>SANS Summit 2022</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2022_velocon/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2022_velocon/>Velocon 2022</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2022_dfrws_apac/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2022_dfrws_apac/>DFRWS APAC 2022</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2023_everything_open/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2023_everything_open/>EverythingOpen 2023</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2023_velocon/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2023_velocon/>VeloCON 2023</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2024_auscert/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2024_auscert/>Auscert 2024</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2024_auscert-detection-engineering/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2024_auscert-detection-engineering/>Auscert 2024 Talk</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/exchange/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/exchange/><i class="fas fa-code"></i>Artifact Exchange</a></div></li><li data-nav-id=https://docs.velociraptor.app/artifact_references/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/artifact_references/><i class="fas fa-book"></i>Artifact Reference</a></div></li><li data-nav-id=https://docs.velociraptor.app/knowledge_base/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/knowledge_base/><i class="fas fa-brain"></i>Knowledge Base</a></div></li><li data-nav-id=https://docs.velociraptor.app/search/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/search/><i class='fas fa-search'></i>Search</a></div></li></ul><hr><section id=shortcuts><h3></h3><ul><li><a class=padding href=https://github.com/Velocidex/velociraptor><i class='fab fa-github'></i>Github</a></li><li><a class=padding href=https://docs.velociraptor.app/discord/><i class='fab fa-discord'></i>Discord</a></li><li><a class=padding href=https://docs.velociraptor.app/youtube/><i class='fab fa-youtube'></i>YouTube</a></li><li><a class=padding href=mailto:velociraptor-discuss@googlegroups.com><i class='fas fa-envelope'></i>Mailing List</a></li><li><a class=padding href=https://docs.velociraptor.app/rss/><i class='fas fa-rss'></i>RSS</a></li><li><a class=padding href=https://docs.rapid7.com/insightidr/velociraptor-integration/><i class='fa fa-question-circle'></i>Rapid7 Docs</a></li></ul></section><section id=footer><div class=footer-copyright>Brought to you by
<img src=/images/Rapid7_logo.svg class=rapid7><br><i class="fas fa-copyright"></i> 2024</div></section></div></nav><script>$("#sidebar i.fa-angle-right").each(function(){$(this).parent().parent().find("ul").hide()})</script><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=top-github-link><a class=github-link title='Edit this page' href=https://github.com/Velocidex/velociraptor-docs/edit/master/content/docs/forensic/filesystem/paths/_index.md target=blank><i class="fas fa-code-branch"></i>
<span id=top-github-link-text>Edit this page</span></a></div><div id=breadcrumbs itemscope itemtype=http://schema.org/BreadcrumbList><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i>
</a></span><span id=toc-menu><i class="fas fa-list-alt"></i></span>
<span class=links itemprop=itemListElement itemscope itemtype=http://schema.org/ListItem><span itemprop=item><span itemprop=name>Velociraptor Paths</span></span>
<meta itemprop=position content="1"></span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><a href=#the-ospath-abstraction>The OSPath abstraction</a></li><li><a href=#the-glob-plugin>The glob() plugin</a></li><li><a href=#filesystem-accessors-and-ospath>Filesystem accessors and OSPath</a></li><li><a href=#nested-accessors-and-pathspecs>Nested accessors and pathspecs</a></li><li><a href=#nesting-ospath-objects>Nesting OSPath objects.</a></li><li><a href=#summary>Summary</a></li></ul></nav></div></div></div></div><div id=head-tags></div><div id=body-inner><h1>Velociraptor Paths</h1><p>In DFIR we often talk about paths and filesystems. However, these are
usually more complex than they appear.</p><p>Path handling is fundamental to forensic analysis, as a large amount
of relevant information is still kept on disk within a
filesystem. Superficially, We are all familiar with how paths work - a
path is typically a string that we can provide to some OS API (for
example the Windows <code>CreateFile()</code> or Linux <code>open()</code> API) which
facilitates interacting with a file or a directory on the filesystem.</p><p>Unfortunately, the structure of this string is often not well defined
or consistent between operating systems! For example, on windows a
path has the following characteristics:</p><ol><li>The path starts with a &ldquo;drive letter&rdquo; of the form <code>C:</code> or <code>D:</code></li><li>Path directories are separated by a backslash <code>\</code></li><li>There is no leading path separator (i.e. <code>C:\</code> does not start with <code>\</code>).</li><li>Directory names may not contain forward slashes, backslashes or wildcards.</li><li>Filenames are generally case insensitive.</li></ol><p>For example <code>C:\Windows\System32\Notepad.exe</code></p><p>On Linux things are a bit different:</p><ol><li>Paths begin with the slash character (the root of the filesystem)</li><li>Path directories are separated by forward slash</li><li>Directory names may contain backslashes but these are <strong>not</strong> path
separators! Filename may contain pretty much any character (except
null and forward slash).</li></ol><p>For example, a Linux path looks like <code>/usr/bin/ls</code>. However, since
Linux can have backslashes with filenames, the path
<code>/C:\Windows/System32</code> can actually refer to a single directory named
<code>C:\Windows</code> which is contained in the root of the filesystem!</p><p>It gets even more complicated on Windows, where a <code>device name</code> may
appear as the first element of the path. Here it refers to a physical
device, for example <code>\\.\C:\Windows</code> means the <code>Windows</code> directory
inside the filesystem on the device <code>\\.C:</code> - Yes the device can
contain backslashes which are also path separators <strong>except</strong> when
they refer to a device.</p><p>A registry path has other rules:</p><ol><li>It starts with the hive name, e.g. <code>HKEY_LOCAL_MACHINE</code> or <code>HKLM</code></li><li>Components are separated by backslashes</li><li>While key names are analogous to directories, registry keys are
allowed to have forward slash characters.</li><li>While Value name are analogous to files, value name may also have
backslashes!</li></ol><p>For example the following registry path is valid
<code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\.NETFramework\</code> <code>Windows Presentation Foundation\Namespaces\http://schemas.microsoft.com/netfx/2009/xaml/presentation</code>
(with the last registry key being a URL) even though the registry key
contains forward slashes it is just one key component!</p><p>With all these confusing rules we need to develop an abstraction that
allows Velociraptor to handle all these cases correctly.</p><p>Correct path handling is extremely important for Velociraptor, without
it various subtle bugs are encountered where a path is emitted from
one plugin (e.g. <code>glob()</code>) but misinterpreted by other plugins
(e.g. <code>read_file()</code>) which fail to open the same file correctly. Since
this interpretation depends on various contextual information (like
which OS we are running on, or which accessor was used) we need a way
to incorporate this information in the path itself.</p><p>Therefore in Velociraptor we represent paths as an OSPath object - not
a simple string.</p><h2 id=the-ospath-abstraction>The OSPath abstraction</h2><p>In recent Velociraptor releases the <code>OSPath</code> abstraction was introduced to
handle paths in a consistent and resilient way:</p><ol><li><p>Internally paths are always a list of components. For example, the
windows path <code>C:\Windows\System32</code> is represented internally as the
list of components <code>["C:", "Windows", "System32"]</code></p></li><li><p>A Filesystem is treated as a tree, and the path is simply the list
of components connecting each level in the tree.</p></li><li><p>An <code>OSPath</code> implements specific serialization and deserialization
methods: When we need to pass an OSPath object to the OS API we
need to serialize the abstract OSPath in a way that is appropriate
to the OS. Otherwise we prefer to retain the OSPath as an abstract
path as much as possible.</p></li><li><p>Each <code>OSPath</code> has a specific flavor - controlling for the way it is
serialized to and from a string. For example a Windows OSPath will
serialize the components using the Windows path rules.</p></li></ol><p>For example, an OSPath with the following components <code>["C:", "Windows", "System32"]</code> will serialize to string:</p><ul><li>A Windows <code>OSPath</code> will serialize to <code>C:\Windows\System32</code></li><li>A Linux <code>OSPath</code> will serialize to <code>/C:/Windows/System32</code></li><li>A Windows NTFS aware OSPath will serialize to
<code>\\.\C:\Windows\System32</code> (i.e. device notation appropriate to the
NTFS raw accessor).</li></ul><p>Velociraptor always represents paths as OSPath objects. You can create
the OSPath object using the <code>pathspec()</code> function, or by providing a
string to VQL functions that require an OSPath, the relevant accessor
is used to parse that string into an OSPath object appropriate for
that accessor.</p><h2 id=the-glob-plugin>The glob() plugin</h2><p>One of the most commonly used plugins in Velociraptor is the <code>glob()</code>
plugin. This plugin allows searching of filesystems using a glob
expression (containing wildcards).</p><p>Consider the following query running on windows</p><pre><code class=language-vql>SELECT OSPath
FROM glob(globs=&quot;*&quot;, root=&quot;C:\\Windows&quot;, accessor=&quot;auto&quot;)
</code></pre><p>The <code>glob()</code> plugin applies the glob expression on the filesystem and
returns a single row for each matching file. Looking at the <a href=/vql_reference/popular/glob/>reference
for the glob()</a>
function, we
can see that the <code>root</code> parameter is of type OSPath.</p><p>Since in the above query, the accessor specified is the <code>auto</code>
accessor, VQL will call on that accessor to interpret the string to an
OSPath before passing it to the <code>glob()</code> function. On windows, the
<code>auto</code> accessor follows the Windows rules above (with <code>\\</code> being the
path separator) to produce an OSPath like this:</p><pre><code>Components: [&quot;C:&quot;, &quot;Windows&quot;]
PathType: &quot;Windows&quot;
</code></pre><p>Note that on Linux, the same path will be interpreted as:</p><pre><code>Components: [&quot;C:\\Windows&quot;]
PathType: &quot;Linux&quot;
</code></pre><p>Since the <code>\\</code> is not a path separator on Linux!</p><p>The OSPath object has some convenient properties:</p><ul><li><p>The <code>Components</code> field contains the list of path components in the
path. You can index the component to identify a specific directory
or filename. (negative indexes are counted from the end of the
component array).</p></li><li><p>The <code>Basename</code> property is a shorthand to the last component
(equivalent to <code>OSPath.Components[-1]</code>)</p></li><li><p>The <code>Dirname</code> property is an OSPath representing the directory
containing the OSPath.</p></li><li><p>Path manipulation is very easy to do, since OSPath is overloading
the addition operator to make path manipulation simple and
intuitive. <strong>There is no need to split or join on path separators in
most cases!</strong></p></li></ul><p>While it may appear that the OSPath a simple string when serialized to
JSON, it is in fact an object with many convenient methods.</p><p><figure id=63a3e92e1f8cd6c120da46d0e5d17c19><div data-featherlight=#63a3e92e1f8cd6c120da46d0e5d17c19 class=figure><img src=ospath.png alt="The OSPath object"></div><figcaption><a class=image-link href=ospath.png><i class="fa fa-download"></i></a>
The OSPath object</figcaption></figure></p><p>The above example shows some common manipulation techniques:</p><ol><li>The component list of the OSPath can be retrieved using
<code>OSPath.Components</code></li><li>The Basename (the last path element) can be retrieved using
<code>OSPath.Basename</code> - this is a string.</li><li>The Directory name of a path is an OSPath with the last component
removed <code>OSPath.Dirname</code>.</li><li>The addition operator on OSPath allows appending further path
components: <code>OSPath + "a/b/c/filename"</code> is another OSPath with an
extra component. The additional string will be split using the
usual path separator.</li><li>Addition with a slice of strings will automatically append
components to the path. For example this query will swap the drive
name from <code>C:</code> too <code>D:</code> by first building an OSPath for <code>D:</code> drive
then adding all the components (except the first one) from the
glob&rsquo;s OSPath to it.</li></ol><pre><code class=language-vql>SELECT pathspec(Path=&quot;D:&quot;, path_type=&quot;windows&quot;) + OSPath[1:]
FROM glob(globs=&quot;C:/Windows/*&quot;)
</code></pre><h2 id=filesystem-accessors-and-ospath>Filesystem accessors and OSPath</h2><p>Velociraptor accesses filesystems by way of an <code>accessor</code>. You can think
of an accessor as a specific driver that VQL can use to open a
path. All VQL plugins or functions that accept files will also accept
an accessor to use to open the file.</p><p>Consider the following VQL query:</p><pre><code class=language-vql>SELECT read_file(path=&quot;C:/Windows/notepad.exe&quot;, accessor=&quot;file&quot;)
FROM scope()
</code></pre><p>The <code>read_file()</code> VQL function reads raw data from the specified
file. The <code>path</code> argument is defined of type OSPath. Since we passed a
string here, VQL will need to convert it into an OSPath by calling
onto the &ldquo;file&rdquo; accessor and pass the provided path to it as an opaque
string.</p><p>The <code>file</code> accessor is used to open files using the OS
APIs. Therefore, it will interpret the path string according to the OS
convention it is running on (i.e. on Windows it will create a Windows
flavor of OSPath). However, were we to use another accessor, the
string path will be interpreted differently by the accessor.</p><div class="mynotices note"><div heading=" Interpreting paths "><p>The most important takeaway from this is that when an accessor
receives a string path, it will parse it into an OSPath internally
according to its own rules. However, internally OSPath objects are
passed directly into the VQL query.</p><p>When a plugin receives an already parsed OSPath object, it may
directly use it (since no parsing is required). Therefore in general,
once an OSPath object is produced in the query, the same OSPath object
should be passed around to other plugins/vql functions.</p><pre><code class=language-vql>SELECT read_file(filename=OSPath, accessor=&quot;file&quot;, length=5)
FROM glob(globs=&quot;C:\\Windows\\notepad.exe&quot;)
</code></pre><p>In the above the string <code>C:\Windows\notepad.exe</code> is parsed once into
an OSPath object, but then <code>glob()</code> passes an OSPath object already so
<code>read_file()</code> does not need to parse anything. This increases
efficiency in VQL because we avoid having to parse and serialized
paths all the time!</p></div></div><h2 id=nested-accessors-and-pathspecs>Nested accessors and pathspecs</h2><p>Many VQL accessors require additional information to be able to
work. For example consider the <code>zip</code> accessor. This accessor is used
to read zip archive members as if they were simple files. In order to
open an archive member we need several pieces of information:</p><ol><li>The path to the zip file itself.</li><li>An accessor to use to open the zip file container.</li><li>The path to the zip member inside the container to open.</li></ol><p>The <code>zip</code> accessor therefore requires a more complex OSPath object
containing additional information about the <code>Delegate</code> (i.e. the path
and accessor that the zip accessor will delegate the actual reading
to). An OSPath Delegate is another path and accessor used by an
accessor to be able to open the file it depends on.</p><p>We call this more complex path specification a <code>pathspec</code> as it
specifies more precisely what the accessor should do. In a VQL query
we may build a pathspec from scratch using the <code>pathspec</code> function.</p><pre><code class=language-vql>SELECT read_file(
  filename=pathspec(DelegateAccessor=&quot;file&quot;,
                    DelegatePath=&quot;F:/hello.zip&quot;,
                    Path=&quot;hello.txt&quot;),
  accessor=&quot;zip&quot;,
  length=5)
FROM scope()
</code></pre><p>In the above example I am calling the <code>read_file()</code> VQL function, and
building an OSPath object directly using the <code>pathspec()</code> VQL
function.</p><p>The <code>zip</code> accessor receives the new OSPath object and</p><ol><li>Will open the zip container itself using the <code>Delegate</code>: i.e. the
&ldquo;file&rdquo; accessor, with a path of &ldquo;F:/hello.zip&rdquo;.</li><li>After parsing the zip file, the <code>zip</code> accessor will open the member
within it specified by the <code>Path</code> field. For zip files, the path is
interpreted as a forward slash separated unix like path (according
to the zip specification). In this case the zip accessor will open
a member called <code>hello.txt</code> within that Zip file.</li><li>Finally the <code>read_file()</code> function will read that member file and
receive the content of the <code>hello.txt</code> archive member.</li></ol><p>Note that in practice we rarely need to build the OSPath directly like
in the example above, because the OSPath object is passed already from
another plugin (e.g. <code>glob()</code>)</p><h2 id=nesting-ospath-objects>Nesting OSPath objects.</h2><p>We can combine the previous two queries to search zip files</p><pre><code class=language-vql>SELECT OSPath,
   read_file(filename=OSPath, accessor=&quot;zip&quot;, length=5)
FROM glob(
  globs=&quot;*.txt&quot;,
  root=pathspec(DelegateAccessor=&quot;auto&quot;, DelegatePath=&quot;F:/hello.zip&quot;, Path=&quot;/&quot;),
  accessor=&quot;zip&quot;)
</code></pre><p>This time we provide the <code>glob()</code> plugin the root (where searching
will begin) as a full OSPath object that we construct to represent the
top level of the zip archive (i.e. globing will proceed within the zip
file).</p><p>In practice <code>Path="/"</code> can be omitted since this is the default
value. Similarly, <code>DelegateAccessor="auto"</code> can also be omitted since
this is the default accessor, thus simplifying the above query.</p><p>We can transparently now pass the OSPath object that glob will return
directly into any VQL function or plugin that accepts a file
(e.g. <code>read_file()</code>)</p><p><figure id=2eb69d1edc86b3b1225d0fd82443289f><div data-featherlight=#2eb69d1edc86b3b1225d0fd82443289f class=figure><img src=nested_pathspec.png alt="Handling nested OSPath objects"></div><figcaption><a class=image-link href=nested_pathspec.png><i class="fa fa-download"></i></a>
Handling nested OSPath objects</figcaption></figure></p><p>The OSPath object is now capable of more complex path manipulations:</p><ol><li><p>The <code>OSPath.Dirname</code> property represents the fully qualified OSPath
used to represent the container directory - we can simply pass it
directly to any plugins that deal with directories.</p></li><li><p>Note that more complex <code>Pathspec</code> based paths are represented as a
JSON encoded object. It is ok to pass the stringified version of
OSPath to plugins because they will automatically parse the
string into an OSPath object.</p></li></ol><div class="mynotices info"><div heading=" Glob's root parameter "><p>When using the <code>glob()</code> plugin, remember that Glob expressions are
always flat strings (i.e. a glob is not a pathspec). An OSPath should
be passed to the <code>root</code> parameter to indicate where searching should
start from. This allows <code>glob()</code> to search inside nested containers
(e.g. zip files) by specifying the <code>root</code> parameter inside the zip
file like in the example above.</p></div></div><h2 id=summary>Summary</h2><p>Path representation is surprisingly much more complex that it first
appears. While paths are strings, internally Velociraptor treats them
as a sequence of components with different flavors controlling how
they are serialized and represented. This affords the VQL query a more
powerful way to manipulate paths and build new paths based on them.</p><p>For more complex accessors, paths are represented as a JSON serialized
<code>OSPath</code> object, describing a delegate path as well. Using the
<code>OSPath</code> object methods does the right thing even for more complex
path and makes it a lot easier to manipulate (for example
<code>OSPath.Dirname</code> is a valid and correct <code>OSPath</code> for the containing
directory, even for more complex pathspec based paths)</p><p>Velociraptor&rsquo;s path handling abstraction is clear and simple and has
consistent rules. We will see how this enables Velociraptor&rsquo;s
remapping rules in the next section.</p><footer class=footline></footer></div></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=/js/clipboard.min.js?1740233287></script><script src=/js/perfect-scrollbar.min.js?1740233287></script><script src=/js/perfect-scrollbar.jquery.min.js?1740233287></script><script src=/js/jquery.sticky.js?1740233287></script><script src=/js/featherlight.min.js?1740233287></script><script src=/js/highlight.min.js?1740233287></script><script>hljs.highlightAll()</script><script src=/js/modernizr.custom-3.6.0.js?1740233287></script><script src=/js/learn.js?1740233287></script><script src=/js/hugo-learn.js?1740233287></script></body></html>