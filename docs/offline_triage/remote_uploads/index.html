<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.139.4"><meta name=description content><link rel=icon href=/images/favicon.png type=image/png><title>Remote Uploads :: Velociraptor - Digging deeper!</title>
<link href=/css/nucleus.css?1740233287 rel=stylesheet><link href=/css/fontawesome-all.min.css?1740233287 rel=stylesheet><link href=/css/featherlight.min.css?1740233287 rel=stylesheet><link href=/css/perfect-scrollbar.min.css?1740233287 rel=stylesheet><link href=/css/auto-complete.css?1740233287 rel=stylesheet><link href=/css/theme.css?1740233287 rel=stylesheet><link href=/css/tabs.css?1740233287 rel=stylesheet><link href=/css/hugo-theme.css?1740233287 rel=stylesheet><link href=/css/theme-mine.css?1740233287 rel=stylesheet><link href=/css/dark.css?1740233287 rel=stylesheet><link href=/css/syntax.css?1740233287 rel=stylesheet><link href=/css/light.css?1740233287 rel=stylesheet><link href=/css/hljs.css?1740233287 rel=stylesheet><link href=https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css?1740233287 rel=stylesheet><script src=/js/jquery-3.3.1.min.js?1740233287></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style><script async src="https://www.googletagmanager.com/gtag/js?id=G-QYH72LMYCS"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-QYH72LMYCS")}</script><script></script></head><body data-url=/docs/offline_triage/remote_uploads/><nav id=sidebar><div id=header-wrapper><div id=header><script>function darkmode(){$("body").addClass("dark").removeClass("light"),document.cookie="theme=darkmode;path=/"}function lightmode(){$("body").removeClass("dark").addClass("light"),document.cookie="theme=lightmode;path=/"}const regex=new RegExp("theme=darkmode");regex.test(document.cookie)?darkmode():lightmode()</script><div class="btn btn-default ThemeSelector darkmode" onclick=darkmode()><i class="fas fa-moon"></i></div><div class="btn btn-default ThemeSelector lightmode" onclick=lightmode()><i class="fas fa-sun"></i></div><a href=https://docs.velociraptor.app/><img src=https://docs.velociraptor.app//images/logo.svg></a></div></div><div class=highlightable><ul class=topics><li data-nav-id=https://docs.velociraptor.app/announcements/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/announcements/><i class="fas fa-bullhorn"></i>Announcements</a></div><ul><li data-nav-id=https://docs.velociraptor.app/announcements/advisories/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/announcements/advisories/><i class="fas fa-exclamation-triangle"></i>Security Advisories</a></div><ul><li data-nav-id=https://docs.velociraptor.app/announcements/advisories/cve-2024-10526/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/announcements/advisories/cve-2024-10526/>CVE-2024-10526</a></div></li><li data-nav-id=https://docs.velociraptor.app/announcements/advisories/cve-2023-5950/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/announcements/advisories/cve-2023-5950/>CVE-2023-5950</a></div></li><li data-nav-id=https://docs.velociraptor.app/announcements/advisories/cve-2023-2226/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/announcements/advisories/cve-2023-2226/>CVE-2023-2226</a></div></li><li data-nav-id=https://docs.velociraptor.app/announcements/advisories/cve-2023-0242/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/announcements/advisories/cve-2023-0242/>CVE-2023-0242</a></div></li><li data-nav-id=https://docs.velociraptor.app/announcements/advisories/cve-2023-0290/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/announcements/advisories/cve-2023-0290/>CVE-2023-0290</a></div></li></ul></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/ class="dd-item parent haschildren"><div><i class="fa fa-angle-down fa-sm category-icon"></i>
<a href=/docs/><i class="fas fa-book-reader"></i>Documentation</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/overview/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/overview/>Velociraptor Overview</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/overview/history/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/overview/history/>History</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/overview/support/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/overview/support/>Support Policy</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/deployment/>Deployment</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/deployment/self-signed/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/self-signed/>Self-Signed SSL</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/cloud/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/deployment/cloud/>Cloud Deployment</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/deployment/cloud/multifrontend/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/cloud/multifrontend/>Multi-Frontend</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/orgs/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/orgs/>Organizations</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/clients/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/clients/>Deploying Clients</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/security/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/security/>Security</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/resources/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/resources/>Performance</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/troubleshooting/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/troubleshooting/>Troubleshooting</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/references/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/deployment/references/><i class="fas fa-book"></i>Config Reference</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/deployment/references/_reference/ class=dd-item><div><a href=/docs/deployment/references/_reference/></a></div></li></ul></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/gui/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/gui/>The Admin GUI</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/clients/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/clients/>Managing Clients</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/clients/searching/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/clients/searching/>Searching for clients</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/clients/interrogation/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/clients/interrogation/>Interrogation</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/clients/artifacts/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/clients/artifacts/>Collecting Artifacts</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/clients/labels/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/clients/labels/>Labels</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/clients/metadata/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/clients/metadata/>Metadata</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/clients/quarantine/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/clients/quarantine/>Quarantine</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/clients/vfs/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/clients/vfs/>Virtual File System</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/clients/shell/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/clients/shell/>Shell Commands</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/clients/monitoring/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/clients/monitoring/>Monitoring</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/clients/troubleshooting/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/clients/troubleshooting/>Troubleshooting</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/vql/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/vql/>VQL</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/vql/fundamentals/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/vql/fundamentals/>VQL Fundamentals</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/vql/events/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/vql/events/>Event Queries</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/vql/join/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/vql/join/>JOIN in VQL</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/vql/extending_vql/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/vql/extending_vql/>Extending VQL</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/vql/vql_reference/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/vql/vql_reference/><i class="fas fa-book"></i>VQL Reference</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/artifacts/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/artifacts/>Artifacts</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/artifacts/artifact_reference/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/artifacts/artifact_reference/><i class="fas fa-book"></i>Artifact Reference</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/artifacts/exchange_reference/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/artifacts/exchange_reference/><i class="fas fa-code"></i>Artifact Exchange</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/notebooks/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/notebooks/>Notebooks</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/hunting/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/hunting/>Hunting</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/forensic/>Forensic Analysis</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/forensic/filesystem/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/forensic/filesystem/>Searching Filenames</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/forensic/filesystem/paths/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/filesystem/paths/>Velociraptor Paths</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/filesystem/remapping/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/filesystem/remapping/>Remapping Accessors</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/searching/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/searching/>Searching Content</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/ntfs/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/ntfs/>NTFS Analysis</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/binary/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/binary/>Binary parsing</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/evidence_of_execution/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/evidence_of_execution/>Evidence Of Execution</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/event_logs/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/event_logs/>Event Logs</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/volatile/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/volatile/>Volatile State</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/offline_triage/ class="dd-item parent haschildren"><div><i class="fa fa-angle-down fa-sm category-icon"></i>
<a href=/docs/offline_triage/>Triage and acquisition</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/offline_triage/remote_uploads/ class="dd-item active"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/offline_triage/remote_uploads/>Remote Uploads</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/server_automation/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/server_automation/>Server Automation</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/server_automation/server_api/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/server_automation/server_api/>Server API</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/server_automation/server_monitoring/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/server_automation/server_monitoring/>Server Monitoring</a></div></li></ul></li></ul></li><li data-nav-id=https://docs.velociraptor.app/downloads/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/downloads/><i class="fas fa-download"></i>Downloads</a></div></li><hr><li data-nav-id=https://docs.velociraptor.app/vql_reference/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/vql_reference/><i class="fas fa-book"></i>VQL Reference</a></div><ul><li data-nav-id=https://docs.velociraptor.app/vql_reference/popular/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/popular/>Frequently Used âœ¨</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/windows/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/windows/>Windows-only</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/linux/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/linux/>Linux-only</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/server/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/server/>Server-only</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/parsers/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/parsers/>Parsers</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/encode/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/encode/>Encode/Decode</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/event/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/event/>Event Plugins</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/experimental/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/experimental/>Experimental</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/developer/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/developer/>Developer</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/other/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/other/>Other</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/accessors/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/accessors/>Accessors</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/training/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/training/><i class="fas fa-graduation-cap"></i>Training</a></div><ul><li data-nav-id=https://docs.velociraptor.app/training/playbooks/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/training/playbooks/><i class="fas fa-play"></i>Playbooks</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/blog/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/blog/><i class="fas fa-newspaper"></i>Blog</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/presentations/><i class="fas fa-chalkboard-teacher"></i>Presentations</a></div><ul><li data-nav-id=https://docs.velociraptor.app/presentations/2022_linuxconf_au/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2022_linuxconf_au/>Linux Conf Au 2022</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2022_auscert/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2022_auscert/>Auscert 2022</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2022_sans_summit/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2022_sans_summit/>SANS Summit 2022</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2022_velocon/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2022_velocon/>Velocon 2022</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2022_dfrws_apac/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2022_dfrws_apac/>DFRWS APAC 2022</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2023_everything_open/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2023_everything_open/>EverythingOpen 2023</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2023_velocon/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2023_velocon/>VeloCON 2023</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2024_auscert/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2024_auscert/>Auscert 2024</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2024_auscert-detection-engineering/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2024_auscert-detection-engineering/>Auscert 2024 Talk</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/exchange/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/exchange/><i class="fas fa-code"></i>Artifact Exchange</a></div></li><li data-nav-id=https://docs.velociraptor.app/artifact_references/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/artifact_references/><i class="fas fa-book"></i>Artifact Reference</a></div></li><li data-nav-id=https://docs.velociraptor.app/knowledge_base/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/knowledge_base/><i class="fas fa-brain"></i>Knowledge Base</a></div></li><li data-nav-id=https://docs.velociraptor.app/search/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/search/><i class='fas fa-search'></i>Search</a></div></li></ul><hr><section id=shortcuts><h3></h3><ul><li><a class=padding href=https://github.com/Velocidex/velociraptor><i class='fab fa-github'></i>Github</a></li><li><a class=padding href=https://docs.velociraptor.app/discord/><i class='fab fa-discord'></i>Discord</a></li><li><a class=padding href=https://docs.velociraptor.app/youtube/><i class='fab fa-youtube'></i>YouTube</a></li><li><a class=padding href=mailto:velociraptor-discuss@googlegroups.com><i class='fas fa-envelope'></i>Mailing List</a></li><li><a class=padding href=https://docs.velociraptor.app/rss/><i class='fas fa-rss'></i>RSS</a></li><li><a class=padding href=https://docs.rapid7.com/insightidr/velociraptor-integration/><i class='fa fa-question-circle'></i>Rapid7 Docs</a></li></ul></section><section id=footer><div class=footer-copyright>Brought to you by
<img src=/images/Rapid7_logo.svg class=rapid7><br><i class="fas fa-copyright"></i> 2024</div></section></div></nav><script>$("#sidebar i.fa-angle-right").each(function(){$(this).parent().parent().find("ul").hide()})</script><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=top-github-link><a class=github-link title='Edit this page' href=https://github.com/Velocidex/velociraptor-docs/edit/master/content/docs/offline_triage/remote_uploads/_index.md target=blank><i class="fas fa-code-branch"></i>
<span id=top-github-link-text>Edit this page</span></a></div><div id=breadcrumbs itemscope itemtype=http://schema.org/BreadcrumbList><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i>
</a></span><span id=toc-menu><i class="fas fa-list-alt"></i></span>
<span class=links itemprop=itemListElement itemscope itemtype=http://schema.org/ListItem><span itemprop=item><span itemprop=name>Remote Uploads</span></span>
<meta itemprop=position content="1"></span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><a href=#encrypting-the-collection>Encrypting the collection</a><ul><li><a href=#password-encryption>Password encryption</a></li><li><a href=#x509-certificate-based-encryption>X509 certificate based encryption</a></li></ul></li><li><a href=#zip-archive>Zip Archive</a></li><li><a href=#smb-share>SMB Share</a></li><li><a href=#azure-blob-storage>Azure Blob Storage</a></li></ul></nav></div></div></div></div><div id=head-tags></div><div id=body-inner><h1>Remote Uploads</h1><p>By default, Velociraptor&rsquo;s offline collector will create a ZIP file
containing all the collected files and artifacts. However, this zip
file is normally large and we may not want to rely on the person
collecting the data to handle sending us the archive file. Instead,
Velociraptor&rsquo;s offline collector can upload the collected archive to a
remote location automatically when the collection is done.</p><p><figure id=05d3a9b26e49a1b3c1f48ae2306c78a9><div data-featherlight=#05d3a9b26e49a1b3c1f48ae2306c78a9 class=figure><img src=offline_collection_types.png alt="The Offline Collector supports many types of uploads"></div><figcaption><a class=image-link href=offline_collection_types.png><i class="fa fa-download"></i></a>
The Offline Collector supports many types of uploads</figcaption></figure></p><p>In this page we discuss how to use some of these options. The correct
option to choose in any specific scenario depends on many factors,
such as network access, cost and availability.</p><h2 id=encrypting-the-collection>Encrypting the collection</h2><p>Velociraptor&rsquo;s artifact collections typically include a lot of
potentially sensitive information, such as logs, user activity etc. By
default the archive produced is a simple ZIP file, but we recommend
the Zip file be protected with some encryption.</p><p><figure id=26e42167a259f28e8dc8fbd1e61a1b44><div data-featherlight=#26e42167a259f28e8dc8fbd1e61a1b44 class=figure><img src=encrytion_schemes.png alt="Output container can be encrypted using a number of schemes"></div><figcaption><a class=image-link href=encrytion_schemes.png><i class="fa fa-download"></i></a>
Output container can be encrypted using a number of schemes</figcaption></figure></p><h3 id=password-encryption>Password encryption</h3><p>Velociraptor can use a ZIP password to encrypt the collected
data. Unfortunately the ZIP encryption standard does not cover the
Central Directory making it possible to see file names, sizes and
other metadata, even if the file content itself is encrypted.</p><p>To mitigate this risk, Velociraptor will create an embedded ZIP file
inside an encrypted container zip file with a fixed name (called
<code>data.zip</code>). This way the file metadata is not exposed without needing
to decrypt the embedded ZIP file.</p><div class="mynotices warning"><div heading=" Password encrypted ZIP files "><p>If using a fixed password to encrypt the collection, the password
needs to be embedded within the collector itself. It is easy to
extract the collector configuration (simply by running <code>collector.exe config show</code>) and therefore the fixed password can be easily
extracted.</p><p>We recommend an asymmetric scheme to be used in practice.</p></div></div><h3 id=x509-certificate-based-encryption>X509 certificate based encryption</h3><p>To avoid needing to embed the password in the collector binary,
Velociraptor offers an X509 scheme. In this scheme the Velociraptor
server embeds its public certificate in the collector binary.</p><p>The offline collector then generates a random password to encrypt the
collection archive with, and in turn encrypts this password with the
embedded public key certificate. This means <strong>only</strong> the server with
the corresponding private key is able to decrypt the zip file.</p><p>To use this option, simply select the <code>X509 Certificate</code> option for
the collector and leave the <code>Public Key/Cert</code> text box blank. The
produced collector will automatically encrypt the container.</p><p><figure id=b8c3dcc20ad69f1b3157436f63108710><div data-featherlight=#b8c3dcc20ad69f1b3157436f63108710 class=figure><img src=encrypting_container.png alt="Offline collector encrypting the output container"></div><figcaption><a class=image-link href=encrypting_container.png><i class="fa fa-download"></i></a>
Offline collector encrypting the output container</figcaption></figure></p><p>The produced collection contains the encrypted data and the metadata
file that can be used to decrypt the file given the correct private
key.</p><p><figure id=0d88efe1c2cda717f668c3dd2474e050><div data-featherlight=#0d88efe1c2cda717f668c3dd2474e050 class=figure><img src=encrypted_file_content.png alt="The contents of the encrypted collection file"></div><figcaption><a class=image-link href=encrypted_file_content.png><i class="fa fa-download"></i></a>
The contents of the encrypted collection file</figcaption></figure></p><p>To extract the X509 encrypted container you can use Velociraptor&rsquo;s
<code>unzip</code> command to decrypt the container automatically. You will need
to provide Velociraptor with the correct config file for the server
that created the collector in the first place. Velociraptor will use
the server&rsquo;s private key to decrypt the container transparently.</p><pre><code>velociraptor.exe --config server.config.yaml unzip Collection-WIN-ADLPBK6BTV0-2023-04-09T07_26_25-07_00.zip
</code></pre><p><figure id=fb3a0640cc43147f3423f3aea1e504f3><div data-featherlight=#fb3a0640cc43147f3423f3aea1e504f3 class=figure><img src=extracting_encrypted_files.png alt="Inspecting the encrypted container"></div><figcaption><a class=image-link href=extracting_encrypted_files.png><i class="fa fa-download"></i></a>
Inspecting the encrypted container</figcaption></figure></p><p>Alternatively, you can import the encrypted collection to the
Velociraptor server using the <code>Server.Utils.ImportCollection</code>
artifact.</p><div class="mynotices tip"><div heading=" X509 encrypted collections "><p>Due to the ease of use and enhanced security provided by the X509
encryption scheme we recommend this to be used in most cases.</p><p>Make sure that you retain the server configuration file that was used
to create the collector in the first place! It is needed to be able to
decrypt the collections.</p></div></div><h2 id=zip-archive>Zip Archive</h2><p>By default Velociraptor&rsquo;s collector will simply create a ZIP file and
leave it in the current directory.</p><p>In many scenarios, the collection is performed by a trusted agent
(such as a remote IT professional). In that case it is useful to
automatically upload the collection to a remote system.</p><p>The following sections document additional options and the best
practice of securing them.</p><h2 id=smb-share>SMB Share</h2><p>SMB is the Microsoft file sharing protocol which is a convenient
option for Windows based systems. Velociraptor supports uploading to
SMB shares since release 0.6.9.</p><p>To configure this option we need to:</p><ol><li>Create a new local uploader user on one of the windows systems
accessible to the host the collection is running on.</li></ol><p><figure id=4735b1767f1cb14402e231e000110ca3><div data-featherlight=#4735b1767f1cb14402e231e000110ca3 class=figure><img src=local_user.png alt="Creating a local user for uploads"></div><figcaption><a class=image-link href=local_user.png><i class="fa fa-download"></i></a>
Creating a local user for uploads</figcaption></figure></p><ol start=2><li>Create a directory to receive the files.</li><li>Share the directory out to the local uploader user.</li></ol><p><figure id=debe7405f95b0f3b0a3f3806d5fe70b2><div data-featherlight=#debe7405f95b0f3b0a3f3806d5fe70b2 class=figure><img src=sharing_directory.png alt="Right click on directory and select properties/sharing tab then click the share button"></div><figcaption><a class=image-link href=sharing_directory.png><i class="fa fa-download"></i></a>
Right click on directory and select properties/sharing tab then click the share button</figcaption></figure></p><ol start=4><li>Adjust directory ACLs to only permit the user to write files
without being able to list the directory or read the files. This is
required because the uploader user credentials must be embedded in
the offline collector so we do not want these misused to alter any
of the other uploads.</li></ol><p><figure id=6a4f4a01090a772626cb9e5dd438ba42><div data-featherlight=#6a4f4a01090a772626cb9e5dd438ba42 class=figure><img src=directory_permissions.png alt="Adjusting directory permissions to only provide write access"></div><figcaption><a class=image-link href=directory_permissions.png><i class="fa fa-download"></i></a>
Adjusting directory permissions to only provide write access</figcaption></figure></p><p>It is best to test the SMB configuration works as desired using the
simple VQL query in a notebook.</p><pre><code class=language-vql>LET SMB_CREDENTIALS &lt;= dict(`192.168.1.112`=&quot;uploader:test!password&quot;)

SELECT upload_smb(accessor=&quot;data&quot;,
    file=&quot;Hello world&quot;,
    name=&quot;hello.txt&quot;,
    server_address=&quot;//192.168.1.112/uploads&quot;)
FROM scope()

SELECT *
FROM glob(globs=&quot;*&quot;,
    root=&quot;//192.168.1.112/uploads&quot;,
    accessor=&quot;smb&quot;)
</code></pre><p>The above query:</p><ol><li>Sets the global credential cache for use of SMB</li><li>Uploads a test file called &ldquo;hello.txt&rdquo; to the uploader directory</li><li>Attempts to list the uploads directory using the <code>glob</code> plugin.</li></ol><p>The upload file should succeed but the <code>uploader</code> user should not be
able to list the directory.</p><p><figure id=509c05cedfa21d546ed8c3278436e88c><div data-featherlight=#509c05cedfa21d546ed8c3278436e88c class=figure><img src=testing_smb.png alt="Testing the SMB permissions with a VQL query"></div><figcaption><a class=image-link href=testing_smb.png><i class="fa fa-download"></i></a>
Testing the SMB permissions with a VQL query</figcaption></figure></p><p>We are now ready to specify the details to the offline collection
GUI. NOTE: Usually it is better to use the IP of the server rather
than the name for improved reliability.</p><p><figure id=c13f78129bebac1bbd42dd6665ca1048><div data-featherlight=#c13f78129bebac1bbd42dd6665ca1048 class=figure><img src=creating_smb_collector.png alt="Creating the SMB offline collector"></div><figcaption><a class=image-link href=creating_smb_collector.png><i class="fa fa-download"></i></a>
Creating the SMB offline collector</figcaption></figure></p><h2 id=azure-blob-storage>Azure Blob Storage</h2><p>Velociraptor supports uploading to Azure since version 0.6.9.</p><p>Azure is a popular cloud provider by Microsoft, and this is a popular
choice for uploading collection archives from remote systems. This
choice is suitable when the system is internet connected and you do
not want to make other changes to the network (e.g. standing up an SMB
server as above).</p><p>Azure supports an authentication policy called <a href=https://learn.microsoft.com/en-us/azure/storage/common/storage-sas-overview target=_blank>Shared Access
Signature
(SAS)</a>
making it convenient and secure to provide limited access to the
a storage container. Using this method, we can embed a simple SAS URL
that provides access to upload data to the storage container without
granting the ability to download or remove any data. This is ideal for
embedding in the offline collector.</p><p>The steps required to set up Azure access are:</p><ol><li>Create a storage account.</li><li>Create a new data storage container to receive the uploads</li></ol><p><figure id=377e342b6dbda3eb28d47de6b6fcfb48><div data-featherlight=#377e342b6dbda3eb28d47de6b6fcfb48 class=figure><img src=creating_azure_container.png alt="Creating a new Azure Blob storage container"></div><figcaption><a class=image-link href=creating_azure_container.png><i class="fa fa-download"></i></a>
Creating a new Azure Blob storage container</figcaption></figure></p><ol start=3><li>Add a role assignment to allow the storage account to manage the storage</li></ol><p><figure id=f43655730b68940d6337dc673e2ed576><div data-featherlight=#f43655730b68940d6337dc673e2ed576 class=figure><img src=azure_role_assignment.png alt="Adding a role assignment to the storage account"></div><figcaption><a class=image-link href=azure_role_assignment.png><i class="fa fa-download"></i></a>
Adding a role assignment to the storage account</figcaption></figure></p><ol start=3><li>Generate a SAS Policy URL.</li></ol><p><figure id=489bca0c8c05a34b908b3f2a6947f913><div data-featherlight=#489bca0c8c05a34b908b3f2a6947f913 class=figure><img src=generating_sas_policy.png alt="Right click on the container to generate a SAS policy"></div><figcaption><a class=image-link href=generating_sas_policy.png><i class="fa fa-download"></i></a>
Right click on the container to generate a SAS policy</figcaption></figure></p><ol start=4><li>Create a SAS policy with only write and create access. You can
specify an appropriate expiry time for the SAS URL. After this time
the uploader will no longer work.</li></ol><p><figure id=bf0d8a9a1f9e7a8a2adaf699d2a23f40><div data-featherlight=#bf0d8a9a1f9e7a8a2adaf699d2a23f40 class=figure><img src=sas_policy_details.png alt="SAS Policy should have only Write and Create Access"></div><figcaption><a class=image-link href=sas_policy_details.png><i class="fa fa-download"></i></a>
SAS Policy should have only Write and Create Access</figcaption></figure></p><ol start=5><li>Test the SAS URL works properly</li></ol><p><figure id=08e9c52adfdae61b436abe10a7c40113><div data-featherlight=#08e9c52adfdae61b436abe10a7c40113 class=figure><img src=testing_sas_url.png alt="Test the SAS Policy by uploading a small file in the notebook"></div><figcaption><a class=image-link href=testing_sas_url.png><i class="fa fa-download"></i></a>
Test the SAS Policy by uploading a small file in the notebook</figcaption></figure></p><ol start=6><li>Embed the SAS URL in the offline collector.</li></ol><p><figure id=52b9912466a495aba594ee90b69c625d><div data-featherlight=#52b9912466a495aba594ee90b69c625d class=figure><img src=sas_collector.png alt="Simply paste the SAS URL in the collector GUI"></div><figcaption><a class=image-link href=sas_collector.png><i class="fa fa-download"></i></a>
Simply paste the SAS URL in the collector GUI</figcaption></figure></p><footer class=footline></footer></div></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=/js/clipboard.min.js?1740233287></script><script src=/js/perfect-scrollbar.min.js?1740233287></script><script src=/js/perfect-scrollbar.jquery.min.js?1740233287></script><script src=/js/jquery.sticky.js?1740233287></script><script src=/js/featherlight.min.js?1740233287></script><script src=/js/highlight.min.js?1740233287></script><script>hljs.highlightAll()</script><script src=/js/modernizr.custom-3.6.0.js?1740233287></script><script src=/js/learn.js?1740233287></script><script src=/js/hugo-learn.js?1740233287></script></body></html>